define(["exports"],(function(t){"use strict";var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=function(t,e,r,i,s,a,o,l,c,u){var h=this;h.numeralDecimalMark=t||".",h.numeralIntegerScale=e>0?e:0,h.numeralDecimalScale=r>=0?r:2,h.numeralThousandsGroupStyle=i||n.groupStyle.thousand,h.numeralPositiveOnly=!!s,h.stripLeadingZeroes=!1!==a,h.prefix=o||""===o?o:"",h.signBeforePrefix=!!l,h.tailPrefix=!!c,h.delimiter=u||""===u?u:",",h.delimiterRE=u?new RegExp("\\"+u,"g"):""};n.groupStyle={thousand:"thousand",lakh:"lakh",wan:"wan",none:"none"},n.prototype={getRawValue:function(t){return t.replace(this.delimiterRE,"").replace(this.numeralDecimalMark,".")},format:function(t){var e,r,i,s,a=this,o="";switch(t=t.replace(/[A-Za-z]/g,"").replace(a.numeralDecimalMark,"M").replace(/[^\dM-]/g,"").replace(/^\-/,"N").replace(/\-/g,"").replace("N",a.numeralPositiveOnly?"":"-").replace("M",a.numeralDecimalMark),a.stripLeadingZeroes&&(t=t.replace(/^(-)?0+(?=\d)/,"$1")),r="-"===t.slice(0,1)?"-":"",i=void 0!==a.prefix?a.signBeforePrefix?r+a.prefix:a.prefix+r:r,s=t,t.indexOf(a.numeralDecimalMark)>=0&&(s=(e=t.split(a.numeralDecimalMark))[0],o=a.numeralDecimalMark+e[1].slice(0,a.numeralDecimalScale)),"-"===r&&(s=s.slice(1)),a.numeralIntegerScale>0&&(s=s.slice(0,a.numeralIntegerScale)),a.numeralThousandsGroupStyle){case n.groupStyle.lakh:s=s.replace(/(\d)(?=(\d\d)+\d$)/g,"$1"+a.delimiter);break;case n.groupStyle.wan:s=s.replace(/(\d)(?=(\d{4})+$)/g,"$1"+a.delimiter);break;case n.groupStyle.thousand:s=s.replace(/(\d)(?=(\d{3})+$)/g,"$1"+a.delimiter)}return a.tailPrefix?r+s.toString()+(a.numeralDecimalScale>0?o.toString():"")+a.prefix:i+s.toString()+(a.numeralDecimalScale>0?o.toString():"")}};var r=n,i=function(t,e,n){var r=this;r.date=[],r.blocks=[],r.datePattern=t,r.dateMin=e.split("-").reverse().map((function(t){return parseInt(t,10)})),2===r.dateMin.length&&r.dateMin.unshift(0),r.dateMax=n.split("-").reverse().map((function(t){return parseInt(t,10)})),2===r.dateMax.length&&r.dateMax.unshift(0),r.initBlocks()};i.prototype={initBlocks:function(){var t=this;t.datePattern.forEach((function(e){"Y"===e?t.blocks.push(4):t.blocks.push(2)}))},getISOFormatDate:function(){var t=this,e=t.date;return e[2]?e[2]+"-"+t.addLeadingZero(e[1])+"-"+t.addLeadingZero(e[0]):""},getBlocks:function(){return this.blocks},getValidatedDate:function(t){var e=this,n="";return t=t.replace(/[^\d]/g,""),e.blocks.forEach((function(r,i){if(t.length>0){var s=t.slice(0,r),a=s.slice(0,1),o=t.slice(r);switch(e.datePattern[i]){case"d":"00"===s?s="01":parseInt(a,10)>3?s="0"+a:parseInt(s,10)>31&&(s="31");break;case"m":"00"===s?s="01":parseInt(a,10)>1?s="0"+a:parseInt(s,10)>12&&(s="12")}n+=s,t=o}})),this.getFixedDateString(n)},getFixedDateString:function(t){var e,n,r,i=this,s=i.datePattern,a=[],o=0,l=0,c=0,u=0,h=0,d=0,p=!1;return 4===t.length&&"y"!==s[0].toLowerCase()&&"y"!==s[1].toLowerCase()&&(h=2-(u="d"===s[0]?0:2),e=parseInt(t.slice(u,u+2),10),n=parseInt(t.slice(h,h+2),10),a=this.getFixedDate(e,n,0)),8===t.length&&(s.forEach((function(t,e){switch(t){case"d":o=e;break;case"m":l=e;break;default:c=e}})),d=2*c,u=o<=c?2*o:2*o+2,h=l<=c?2*l:2*l+2,e=parseInt(t.slice(u,u+2),10),n=parseInt(t.slice(h,h+2),10),r=parseInt(t.slice(d,d+4),10),p=4===t.slice(d,d+4).length,a=this.getFixedDate(e,n,r)),4!==t.length||"y"!==s[0]&&"y"!==s[1]||(d=2-(h="m"===s[0]?0:2),n=parseInt(t.slice(h,h+2),10),r=parseInt(t.slice(d,d+2),10),p=2===t.slice(d,d+2).length,a=[0,n,r]),6!==t.length||"Y"!==s[0]&&"Y"!==s[1]||(d=2-.5*(h="m"===s[0]?0:4),n=parseInt(t.slice(h,h+2),10),r=parseInt(t.slice(d,d+4),10),p=4===t.slice(d,d+4).length,a=[0,n,r]),a=i.getRangeFixedDate(a),i.date=a,0===a.length?t:s.reduce((function(t,e){switch(e){case"d":return t+(0===a[0]?"":i.addLeadingZero(a[0]));case"m":return t+(0===a[1]?"":i.addLeadingZero(a[1]));case"y":return t+(p?i.addLeadingZeroForYear(a[2],!1):"");case"Y":return t+(p?i.addLeadingZeroForYear(a[2],!0):"")}}),"")},getRangeFixedDate:function(t){var e=this,n=e.datePattern,r=e.dateMin||[],i=e.dateMax||[];return!t.length||r.length<3&&i.length<3||n.find((function(t){return"y"===t.toLowerCase()}))&&0===t[2]?t:i.length&&(i[2]<t[2]||i[2]===t[2]&&(i[1]<t[1]||i[1]===t[1]&&i[0]<t[0]))?i:r.length&&(r[2]>t[2]||r[2]===t[2]&&(r[1]>t[1]||r[1]===t[1]&&r[0]>t[0]))?r:t},getFixedDate:function(t,e,n){return t=Math.min(t,31),e=Math.min(e,12),n=parseInt(n||0,10),(e<7&&e%2==0||e>8&&e%2==1)&&(t=Math.min(t,2===e?this.isLeapYear(n)?29:28:30)),[t,e,n]},isLeapYear:function(t){return t%4==0&&t%100!=0||t%400==0},addLeadingZero:function(t){return(t<10?"0":"")+t},addLeadingZeroForYear:function(t,e){return e?(t<10?"000":t<100?"00":t<1e3?"0":"")+t:(t<10?"0":"")+t}};var s=i,a=function(t,e){var n=this;n.time=[],n.blocks=[],n.timePattern=t,n.timeFormat=e,n.initBlocks()};a.prototype={initBlocks:function(){var t=this;t.timePattern.forEach((function(){t.blocks.push(2)}))},getISOFormatTime:function(){var t=this,e=t.time;return e[2]?t.addLeadingZero(e[0])+":"+t.addLeadingZero(e[1])+":"+t.addLeadingZero(e[2]):""},getBlocks:function(){return this.blocks},getTimeFormatOptions:function(){return"12"===String(this.timeFormat)?{maxHourFirstDigit:1,maxHours:12,maxMinutesFirstDigit:5,maxMinutes:60}:{maxHourFirstDigit:2,maxHours:23,maxMinutesFirstDigit:5,maxMinutes:60}},getValidatedTime:function(t){var e=this,n="";t=t.replace(/[^\d]/g,"");var r=e.getTimeFormatOptions();return e.blocks.forEach((function(i,s){if(t.length>0){var a=t.slice(0,i),o=a.slice(0,1),l=t.slice(i);switch(e.timePattern[s]){case"h":parseInt(o,10)>r.maxHourFirstDigit?a="0"+o:parseInt(a,10)>r.maxHours&&(a=r.maxHours+"");break;case"m":case"s":parseInt(o,10)>r.maxMinutesFirstDigit?a="0"+o:parseInt(a,10)>r.maxMinutes&&(a=r.maxMinutes+"")}n+=a,t=l}})),this.getFixedTimeString(n)},getFixedTimeString:function(t){var e,n,r,i=this,s=i.timePattern,a=[],o=0,l=0,c=0,u=0,h=0,d=0;return 6===t.length&&(s.forEach((function(t,e){switch(t){case"s":o=2*e;break;case"m":l=2*e;break;case"h":c=2*e}})),d=c,h=l,u=o,e=parseInt(t.slice(u,u+2),10),n=parseInt(t.slice(h,h+2),10),r=parseInt(t.slice(d,d+2),10),a=this.getFixedTime(r,n,e)),4===t.length&&i.timePattern.indexOf("s")<0&&(s.forEach((function(t,e){switch(t){case"m":l=2*e;break;case"h":c=2*e}})),d=c,h=l,e=0,n=parseInt(t.slice(h,h+2),10),r=parseInt(t.slice(d,d+2),10),a=this.getFixedTime(r,n,e)),i.time=a,0===a.length?t:s.reduce((function(t,e){switch(e){case"s":return t+i.addLeadingZero(a[2]);case"m":return t+i.addLeadingZero(a[1]);case"h":return t+i.addLeadingZero(a[0])}}),"")},getFixedTime:function(t,e,n){return n=Math.min(parseInt(n||0,10),60),e=Math.min(e,60),[t=Math.min(t,60),e,n]},addLeadingZero:function(t){return(t<10?"0":"")+t}};var o=a,l=function(t,e){var n=this;n.delimiter=e||""===e?e:" ",n.delimiterRE=e?new RegExp("\\"+e,"g"):"",n.formatter=t};l.prototype={setFormatter:function(t){this.formatter=t},format:function(t){var e=this;e.formatter.clear();for(var n,r="",i=!1,s=0,a=(t=(t=(t=t.replace(/[^\d+]/g,"")).replace(/^\+/,"B").replace(/\+/g,"").replace("B","+")).replace(e.delimiterRE,"")).length;s<a;s++)n=e.formatter.inputDigit(t.charAt(s)),/[\s()-]/g.test(n)?(r=n,i=!0):i||(r=n);return r=(r=r.replace(/[()]/g,"")).replace(/[\s-]/g,e.delimiter)}};var c=l,u={blocks:{uatp:[4,5,6],amex:[4,6,5],diners:[4,6,4],discover:[4,4,4,4],mastercard:[4,4,4,4],dankort:[4,4,4,4],instapayment:[4,4,4,4],jcb15:[4,6,5],jcb:[4,4,4,4],maestro:[4,4,4,4],visa:[4,4,4,4],mir:[4,4,4,4],unionPay:[4,4,4,4],general:[4,4,4,4]},re:{uatp:/^(?!1800)1\d{0,14}/,amex:/^3[47]\d{0,13}/,discover:/^(?:6011|65\d{0,2}|64[4-9]\d?)\d{0,12}/,diners:/^3(?:0([0-5]|9)|[689]\d?)\d{0,11}/,mastercard:/^(5[1-5]\d{0,2}|22[2-9]\d{0,1}|2[3-7]\d{0,2})\d{0,12}/,dankort:/^(5019|4175|4571)\d{0,12}/,instapayment:/^63[7-9]\d{0,13}/,jcb15:/^(?:2131|1800)\d{0,11}/,jcb:/^(?:35\d{0,2})\d{0,12}/,maestro:/^(?:5[0678]\d{0,2}|6304|67\d{0,2})\d{0,12}/,mir:/^220[0-4]\d{0,12}/,visa:/^4\d{0,15}/,unionPay:/^(62|81)\d{0,14}/},getStrictBlocks:function(t){var e=t.reduce((function(t,e){return t+e}),0);return t.concat(19-e)},getInfo:function(t,e){var n=u.blocks,r=u.re;for(var i in e=!!e,r)if(r[i].test(t)){var s=n[i];return{type:i,blocks:e?this.getStrictBlocks(s):s}}return{type:"unknown",blocks:e?this.getStrictBlocks(n.general):n.general}}},h=u,d={noop:function(){},strip:function(t,e){return t.replace(e,"")},getPostDelimiter:function(t,e,n){if(0===n.length)return t.slice(-e.length)===e?e:"";var r="";return n.forEach((function(e){t.slice(-e.length)===e&&(r=e)})),r},getDelimiterREByDelimiter:function(t){return new RegExp(t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"g")},getNextCursorPosition:function(t,e,n,r,i){return e.length===t?n.length:t+this.getPositionOffset(t,e,n,r,i)},getPositionOffset:function(t,e,n,r,i){var s,a,o;return s=this.stripDelimiters(e.slice(0,t),r,i),a=this.stripDelimiters(n.slice(0,t),r,i),0!==(o=s.length-a.length)?o/Math.abs(o):0},stripDelimiters:function(t,e,n){var r=this;if(0===n.length){var i=e?r.getDelimiterREByDelimiter(e):"";return t.replace(i,"")}return n.forEach((function(e){e.split("").forEach((function(e){t=t.replace(r.getDelimiterREByDelimiter(e),"")}))})),t},headStr:function(t,e){return t.slice(0,e)},getMaxLength:function(t){return t.reduce((function(t,e){return t+e}),0)},getPrefixStrippedValue:function(t,e,n,r,i,s,a,o,l){if(0===n)return t;if(t===e&&""!==t)return"";if(l&&"-"==t.slice(0,1)){var c="-"==r.slice(0,1)?r.slice(1):r;return"-"+this.getPrefixStrippedValue(t.slice(1),e,n,c,i,s,a,o,l)}if(r.slice(0,n)!==e&&!o)return a&&!r&&t?t:"";if(r.slice(-n)!==e&&o)return a&&!r&&t?t:"";var u=this.stripDelimiters(r,i,s);return t.slice(0,n)===e||o?t.slice(-n)!==e&&o?u.slice(0,-n-1):o?t.slice(0,-n):t.slice(n):u.slice(n)},getFirstDiffIndex:function(t,e){for(var n=0;t.charAt(n)===e.charAt(n);)if(""===t.charAt(n++))return-1;return n},getFormattedValue:function(t,e,n,r,i,s){var a="",o=i.length>0,l="";return 0===n?t:(e.forEach((function(e,c){if(t.length>0){var u=t.slice(0,e),h=t.slice(e);l=o?i[s?c-1:c]||l:r,s?(c>0&&(a+=l),a+=u):(a+=u,u.length===e&&c<n-1&&(a+=l)),t=h}})),a)},fixPrefixCursor:function(t,e,n,r){if(t){var i=t.value,s=n||r[0]||" ";if(t.setSelectionRange&&e&&!(e.length+s.length<=i.length)){var a=2*i.length;setTimeout((function(){t.setSelectionRange(a,a)}),1)}}},checkFullSelection:function(t){try{return(window.getSelection()||document.getSelection()||{}).toString().length===t.length}catch(t){}return!1},setSelection:function(t,e,n){if(t===this.getActiveElement(n)&&!(t&&t.value.length<=e))if(t.createTextRange){var r=t.createTextRange();r.move("character",e),r.select()}else try{t.setSelectionRange(e,e)}catch(t){console.warn("The input element type does not support selection")}},getActiveElement:function(t){var e=t.activeElement;return e&&e.shadowRoot?this.getActiveElement(e.shadowRoot):e},isAndroid:function(){return navigator&&/android/i.test(navigator.userAgent)},isAndroidBackspaceKeydown:function(t,e){return!!(this.isAndroid()&&t&&e)&&e===t.slice(0,-1)}},p={assign:function(t,n){return n=n||{},(t=t||{}).creditCard=!!n.creditCard,t.creditCardStrictMode=!!n.creditCardStrictMode,t.creditCardType="",t.onCreditCardTypeChanged=n.onCreditCardTypeChanged||function(){},t.phone=!!n.phone,t.phoneRegionCode=n.phoneRegionCode||"AU",t.phoneFormatter={},t.time=!!n.time,t.timePattern=n.timePattern||["h","m","s"],t.timeFormat=n.timeFormat||"24",t.timeFormatter={},t.date=!!n.date,t.datePattern=n.datePattern||["d","m","Y"],t.dateMin=n.dateMin||"",t.dateMax=n.dateMax||"",t.dateFormatter={},t.numeral=!!n.numeral,t.numeralIntegerScale=n.numeralIntegerScale>0?n.numeralIntegerScale:0,t.numeralDecimalScale=n.numeralDecimalScale>=0?n.numeralDecimalScale:2,t.numeralDecimalMark=n.numeralDecimalMark||".",t.numeralThousandsGroupStyle=n.numeralThousandsGroupStyle||"thousand",t.numeralPositiveOnly=!!n.numeralPositiveOnly,t.stripLeadingZeroes=!1!==n.stripLeadingZeroes,t.signBeforePrefix=!!n.signBeforePrefix,t.tailPrefix=!!n.tailPrefix,t.swapHiddenInput=!!n.swapHiddenInput,t.numericOnly=t.creditCard||t.date||!!n.numericOnly,t.uppercase=!!n.uppercase,t.lowercase=!!n.lowercase,t.prefix=t.creditCard||t.date?"":n.prefix||"",t.noImmediatePrefix=!!n.noImmediatePrefix,t.prefixLength=t.prefix.length,t.rawValueTrimPrefix=!!n.rawValueTrimPrefix,t.copyDelimiter=!!n.copyDelimiter,t.initValue=void 0!==n.initValue&&null!==n.initValue?n.initValue.toString():"",t.delimiter=n.delimiter||""===n.delimiter?n.delimiter:n.date?"/":n.time?":":n.numeral?",":(n.phone," "),t.delimiterLength=t.delimiter.length,t.delimiterLazyShow=!!n.delimiterLazyShow,t.delimiters=n.delimiters||[],t.blocks=n.blocks||[],t.blocksLength=t.blocks.length,t.root="object"==typeof e&&e?e:window,t.document=n.document||t.root.document,t.maxLength=0,t.backspace=!1,t.result="",t.onValueChanged=n.onValueChanged||function(){},t}},f=function(t,e){var n=this,r=!1;if("string"==typeof t?(n.element=document.querySelector(t),r=document.querySelectorAll(t).length>1):void 0!==t.length&&t.length>0?(n.element=t[0],r=t.length>1):n.element=t,!n.element)throw new Error("[cleave.js] Please check the element");if(r)try{console.warn("[cleave.js] Multiple input fields matched, cleave.js will only take the first one.")}catch(t){}e.initValue=n.element.value,n.properties=f.DefaultProperties.assign({},e),n.init()};f.prototype={init:function(){var t=this,e=t.properties;e.numeral||e.phone||e.creditCard||e.time||e.date||0!==e.blocksLength||e.prefix?(e.maxLength=f.Util.getMaxLength(e.blocks),t.isAndroid=f.Util.isAndroid(),t.lastInputValue="",t.isBackward="",t.onChangeListener=t.onChange.bind(t),t.onKeyDownListener=t.onKeyDown.bind(t),t.onFocusListener=t.onFocus.bind(t),t.onCutListener=t.onCut.bind(t),t.onCopyListener=t.onCopy.bind(t),t.initSwapHiddenInput(),t.element.addEventListener("input",t.onChangeListener),t.element.addEventListener("keydown",t.onKeyDownListener),t.element.addEventListener("focus",t.onFocusListener),t.element.addEventListener("cut",t.onCutListener),t.element.addEventListener("copy",t.onCopyListener),t.initPhoneFormatter(),t.initDateFormatter(),t.initTimeFormatter(),t.initNumeralFormatter(),(e.initValue||e.prefix&&!e.noImmediatePrefix)&&t.onInput(e.initValue)):t.onInput(e.initValue)},initSwapHiddenInput:function(){var t=this;if(t.properties.swapHiddenInput){var e=t.element.cloneNode(!0);t.element.parentNode.insertBefore(e,t.element),t.elementSwapHidden=t.element,t.elementSwapHidden.type="hidden",t.element=e,t.element.id=""}},initNumeralFormatter:function(){var t=this.properties;t.numeral&&(t.numeralFormatter=new f.NumeralFormatter(t.numeralDecimalMark,t.numeralIntegerScale,t.numeralDecimalScale,t.numeralThousandsGroupStyle,t.numeralPositiveOnly,t.stripLeadingZeroes,t.prefix,t.signBeforePrefix,t.tailPrefix,t.delimiter))},initTimeFormatter:function(){var t=this.properties;t.time&&(t.timeFormatter=new f.TimeFormatter(t.timePattern,t.timeFormat),t.blocks=t.timeFormatter.getBlocks(),t.blocksLength=t.blocks.length,t.maxLength=f.Util.getMaxLength(t.blocks))},initDateFormatter:function(){var t=this.properties;t.date&&(t.dateFormatter=new f.DateFormatter(t.datePattern,t.dateMin,t.dateMax),t.blocks=t.dateFormatter.getBlocks(),t.blocksLength=t.blocks.length,t.maxLength=f.Util.getMaxLength(t.blocks))},initPhoneFormatter:function(){var t=this.properties;if(t.phone)try{t.phoneFormatter=new f.PhoneFormatter(new t.root.Cleave.AsYouTypeFormatter(t.phoneRegionCode),t.delimiter)}catch(t){throw new Error("[cleave.js] Please include phone-type-formatter.{country}.js lib")}},onKeyDown:function(t){var e=this,n=t.which||t.keyCode;e.lastInputValue=e.element.value,e.isBackward=8===n},onChange:function(t){var e=this,n=e.properties,r=f.Util;e.isBackward=e.isBackward||"deleteContentBackward"===t.inputType;var i=r.getPostDelimiter(e.lastInputValue,n.delimiter,n.delimiters);e.isBackward&&i?n.postDelimiterBackspace=i:n.postDelimiterBackspace=!1,this.onInput(this.element.value)},onFocus:function(){var t=this,e=t.properties;t.lastInputValue=t.element.value,e.prefix&&e.noImmediatePrefix&&!t.element.value&&this.onInput(e.prefix),f.Util.fixPrefixCursor(t.element,e.prefix,e.delimiter,e.delimiters)},onCut:function(t){f.Util.checkFullSelection(this.element.value)&&(this.copyClipboardData(t),this.onInput(""))},onCopy:function(t){f.Util.checkFullSelection(this.element.value)&&this.copyClipboardData(t)},copyClipboardData:function(t){var e=this.properties,n=f.Util,r=this.element.value,i="";i=e.copyDelimiter?r:n.stripDelimiters(r,e.delimiter,e.delimiters);try{t.clipboardData?t.clipboardData.setData("Text",i):window.clipboardData.setData("Text",i),t.preventDefault()}catch(t){}},onInput:function(t){var e=this,n=e.properties,r=f.Util,i=r.getPostDelimiter(t,n.delimiter,n.delimiters);return n.numeral||!n.postDelimiterBackspace||i||(t=r.headStr(t,t.length-n.postDelimiterBackspace.length)),n.phone?(!n.prefix||n.noImmediatePrefix&&!t.length?n.result=n.phoneFormatter.format(t):n.result=n.prefix+n.phoneFormatter.format(t).slice(n.prefix.length),void e.updateValueState()):n.numeral?(n.prefix&&n.noImmediatePrefix&&0===t.length?n.result="":n.result=n.numeralFormatter.format(t),void e.updateValueState()):(n.date&&(t=n.dateFormatter.getValidatedDate(t)),n.time&&(t=n.timeFormatter.getValidatedTime(t)),t=r.stripDelimiters(t,n.delimiter,n.delimiters),t=r.getPrefixStrippedValue(t,n.prefix,n.prefixLength,n.result,n.delimiter,n.delimiters,n.noImmediatePrefix,n.tailPrefix,n.signBeforePrefix),t=n.numericOnly?r.strip(t,/[^\d]/g):t,t=n.uppercase?t.toUpperCase():t,t=n.lowercase?t.toLowerCase():t,n.prefix&&(n.tailPrefix?t+=n.prefix:t=n.prefix+t,0===n.blocksLength)?(n.result=t,void e.updateValueState()):(n.creditCard&&e.updateCreditCardPropsByValue(t),t=r.headStr(t,n.maxLength),n.result=r.getFormattedValue(t,n.blocks,n.blocksLength,n.delimiter,n.delimiters,n.delimiterLazyShow),void e.updateValueState()))},updateCreditCardPropsByValue:function(t){var e,n=this.properties,r=f.Util;r.headStr(n.result,4)!==r.headStr(t,4)&&(e=f.CreditCardDetector.getInfo(t,n.creditCardStrictMode),n.blocks=e.blocks,n.blocksLength=n.blocks.length,n.maxLength=r.getMaxLength(n.blocks),n.creditCardType!==e.type&&(n.creditCardType=e.type,n.onCreditCardTypeChanged.call(this,n.creditCardType)))},updateValueState:function(){var t=this,e=f.Util,n=t.properties;if(t.element){var r=t.element.selectionEnd,i=t.element.value,s=n.result;r=e.getNextCursorPosition(r,i,s,n.delimiter,n.delimiters),t.isAndroid?window.setTimeout((function(){t.element.value=s,e.setSelection(t.element,r,n.document,!1),t.callOnValueChanged()}),1):(t.element.value=s,n.swapHiddenInput&&(t.elementSwapHidden.value=t.getRawValue()),e.setSelection(t.element,r,n.document,!1),t.callOnValueChanged())}},callOnValueChanged:function(){var t=this,e=t.properties;e.onValueChanged.call(t,{target:{name:t.element.name,value:e.result,rawValue:t.getRawValue()}})},setPhoneRegionCode:function(t){var e=this;e.properties.phoneRegionCode=t,e.initPhoneFormatter(),e.onChange()},setRawValue:function(t){var e=this,n=e.properties;t=null!=t?t.toString():"",n.numeral&&(t=t.replace(".",n.numeralDecimalMark)),n.postDelimiterBackspace=!1,e.element.value=t,e.onInput(t)},getRawValue:function(){var t=this.properties,e=f.Util,n=this.element.value;return t.rawValueTrimPrefix&&(n=e.getPrefixStrippedValue(n,t.prefix,t.prefixLength,t.result,t.delimiter,t.delimiters,t.noImmediatePrefix,t.tailPrefix,t.signBeforePrefix)),n=t.numeral?t.numeralFormatter.getRawValue(n):e.stripDelimiters(n,t.delimiter,t.delimiters)},getISOFormatDate:function(){var t=this.properties;return t.date?t.dateFormatter.getISOFormatDate():""},getISOFormatTime:function(){var t=this.properties;return t.time?t.timeFormatter.getISOFormatTime():""},getFormattedValue:function(){return this.element.value},destroy:function(){var t=this;t.element.removeEventListener("input",t.onChangeListener),t.element.removeEventListener("keydown",t.onKeyDownListener),t.element.removeEventListener("focus",t.onFocusListener),t.element.removeEventListener("cut",t.onCutListener),t.element.removeEventListener("copy",t.onCopyListener)},toString:function(){return"[Cleave Object]"}},f.NumeralFormatter=r,f.DateFormatter=s,f.TimeFormatter=o,f.PhoneFormatter=c,f.CreditCardDetector=h,f.Util=d,f.DefaultProperties=p,("object"==typeof e&&e?e:window).Cleave=f;var g=f;class m{static get form(){return"form"}static get creditCardImage(){return"creditCardImage"}static get creditCardHolder(){return"creditCardHolder"}static get creditCardNumber(){return"creditCardNumber"}static get creditCardCvv(){return"creditCardCvv"}static get creditCardCvvLabel(){return"creditCardCvvLabel"}static get creditCardCvvImage(){return"creditCardCvvImage"}static get creditCardExpiration(){return"creditCardExpiration"}static get creditCardExpirationMonth(){return"creditCardExpirationMonth"}static get creditCardExpirationYear(){return"creditCardExpirationYear"}static get submitButton(){return"submitButton"}static get modalContainer(){return"modalContainer"}}class v{constructor(t){this.config=t,this.references={},this.lookup={};let e=this;this.lookup[m.form]=function(){return document.querySelector("form["+e.config.form_selector+"]")},this.lookup[m.creditCardImage]=function(){return e.getElementByQuerySelector("img[data-credit-card-type]")},this.lookup[m.creditCardHolder]=function(){return e.getElementByQuerySelector('[name="cardholder"]')},this.lookup[m.creditCardNumber]=function(){return e.getElementByQuerySelector('[name="cardnumber"]')},this.lookup[m.creditCardCvv]=function(){return e.getElementByQuerySelector('[name="cardcvc"]')},this.lookup[m.creditCardCvvLabel]=function(){return e.getElementByQuerySelector("[data-cvc-label]")},this.lookup[m.creditCardCvvImage]=function(){return e.getElementByQuerySelector("img[data-credit-card-cvc]")},this.lookup[m.creditCardExpiration]=function(){return e.getElementByQuerySelector('[name="expiration"]')},this.lookup[m.creditCardExpirationMonth]=function(){return e.getElementByQuerySelector('[name="valid_thru_month"]')},this.lookup[m.creditCardExpirationYear]=function(){return e.getElementByQuerySelector('[name="valid_thru_year"]')},this.lookup[m.submitButton]=function(){return e.getElementByQuerySelector('[type="submit"]')},this.lookup[m.modalContainer]=function(){return document.getElementById("payment-modal")}}getReference(t){if(!(t in this.references)&&!(t in this.lookup))throw new Error("Unknown element reference.");return void 0!==this.references[t]||(this.references[t]=this.lookup[t]()),this.references[t]}getElementByQuerySelector(t){return this.getReference(m.form).querySelector(t)}}class y{constructor(){this.state={loading:!1,inputComplete:!1,cardHolderInputComplete:!1,cardNumberInputComplete:!1,cardCvvInputComplete:!1,cardExpiryMonthInputComplete:!1,cardExpiryYearInputComplete:!1,formReadyForSubmission:!1,formSubmitted:!1,modalOpen:!1},this.config={},this.elements={}}getConfig(){return this.config}setConfig(t){this.config=t}getElementFromReference(t){return this.elements instanceof v||(this.elements=new v(this.config)),this.elements.getReference(t)}getCurrentState(){return this.state}updateState(t){if("object"!=typeof this.state)throw new Error("Unable to update state, expected an object but received "+typeof this.state+".");for(const[e,n]of Object.entries(t))this.state[e]=n;return this}getStateParameter(t){return t in this.state?this.state[t]:null}setStateParameter(t,e){return this.state[t]=e,this}static getInstance(){return y.instance||(y.instance=new y),y.instance}isModalOpen(){return 1===this.state.modalOpen}isModalClosed(){return 0===this.state.modalOpen}isFormReadyForSubmission(){return this.state.formReadyForSubmission&&!this.state.formSubmitted}isFormSubmitted(){return this.state.formSubmitted}isLoading(){return this.state.loading}}class b extends Error{}class E extends b{}class S extends b{static fromAnyException(t){let e=new S(t.message);return e.previousException=t,e}}class w{constructor(){this.instance=null,this.listeners=[],this.sorted=[]}static getInstance(){return w.instance||(w.instance=new w),w.instance}getListeners(t){if(t)return Array.isArray(this.listeners[t])&&0!==this.listeners[t].length?(t in this.sorted&&0!==this.sorted[t].length||this.sortListeners(t),this.sorted[t]):[];for(const[t,e]of Object.entries(this.listeners))t in this.sorted||this.sortListeners(t);return this.sorted}addListener(t,e,n=0){if(n<0)throw new Error("Priority must be a non-negative index.");return t in this.listeners||(this.listeners[t]=[]),n in this.listeners[t]||(this.listeners[t][n]=[]),this.listeners[t][n].push(e),t in this.sorted&&delete this.sorted[t],this}removeListener(t,e){if(this.listeners[t])for(const[n,r]of Object.entries(this.listeners[t])){for(const[i,s]of Object.entries(r))Array.isArray(s)&&2===s.length&&s[0]===e[0]&&s[1]===e[1]&&(delete this.listeners[t][n][i],delete this.sorted[t]),s===e&&(delete this.listeners[t][n][i],delete this.sorted[t]);0===Object.entries(this.listeners[t][n]).length&&delete this.listeners[t][n]}}dispatch(t,e){let n=this.getListeners(e);return n.length>0&&this.callListeners(n,e,t),t}callListeners(t,e,n){try{t.forEach((function(t){if(n.propagationStopped)throw new E;if(Array.isArray(t)&&2===t.length){if("function"!=typeof t[0][t[1]])throw new Error("Could not call method on listener instance.");t[0][t[1]](n,e,this)}else t(n,e,this)}))}catch(t){if(t instanceof E)return;throw S.fromAnyException(t)}}hasListeners(t=null){return t?this.listeners[t]&&this.sorted[t].length>0:this.listeners.length>0}sortListeners(t){this.sorted[t]=[];let e=this.listeners[t].sort((t,e)=>e-t);for(const n of Object.keys(e))for(const r of e[n])this.sorted[t].push(r);return this.sorted}getListenerPriority(t,e){if(this.listeners[t]){for(const[n,r]of Object.entries(this.listeners[t]))for(const t of r){if(Array.isArray(t)&&2===t.length&&t[0]===e[0]&&t[1]===e[1])return n;if(t===e)return n}return null}}}class C{getEventDispatcher(){return w.getInstance()}getState(){return y.getInstance()}}class x{constructor(t,e={}){this.subject=t,this.parameters=e,this.propagationStopped=!1}getSubject(){return this.subject}getParameter(t){if(this.hasParameter(t))return this.parameters[t];throw new Error('Parameter "'+t+'" was not found.')}setParameter(t,e){return this.parameters[t]=e,this}setParameters(t){return this.parameters=t,this}getParameters(){return this.parameters}hasParameter(t){return t in this.parameters}isPropagationStopped(){return this.propagationStopped}stopPropagation(){this.propagationStopped=!0}}class D extends x{}class T{static get onRequestEvent(){return"onRequestEvent"}static get onResponseEvent(){return"onResponseEvent"}static get onResponseFactoryEvent(){return"onResponseFactoryEvent"}static get onStateChangeEvent(){return"onStateChangeEvent"}static get onResolveModalEvent(){return"onResolveModalEvent"}static get onModalOpenEvent(){return"onModalOpenEvent"}static get onModalCloseEvent(){return"onModalCloseEvent"}static get onDebugEvent(){return"onDebugEvent"}static get onExceptionEvent(){return"onExceptionEvent"}static get onPaymentFailedEvent(){return"onPaymentFailedEvent"}static get onPaymentCompleteEvent(){return"onPaymentCompleteEvent"}static get onPaymentRequiresChallengeEvent(){return"onPaymentRequiresChallengeEvent"}static get onSubmitDataEvent(){return"onSubmitDataEvent"}static get onBeforeDisplayModalEvent(){return"onBeforeDisplayModalEvent"}}class R extends C{static onDebugEvent(t){if(t.getSubject()instanceof Error)throw t.getSubject();t.getParameters().length>0?t instanceof D?console.debug(t.event,t.event.getParameters()):console.debug(t.getSubject(),t.getParameters()):console.debug(t.getSubject())}static onDebugNull(){}static onModalCloseEvent(t){w.getInstance().dispatch(new D("Closing modal",{event:t}),T.onDebugEvent)}static onModalOpenEvent(t){w.getInstance().dispatch(new D("Opening modal",{event:t}),T.onDebugEvent)}static onRequestEvent(t){w.getInstance().dispatch(new D("Request received.",{event:t}),T.onDebugEvent)}static onResponseEvent(t){w.getInstance().dispatch(new D("Response received",{event:t}),T.onDebugEvent)}static onResponseFactoryEvent(t){w.getInstance().dispatch(new D("Response factory has resolved response",{event:t}),T.onDebugEvent)}static onStateChangeEvent(t){w.getInstance().dispatch(new D("State has been updated",{event:t,state:t.getCurrentState(),change:t.parameters}),T.onDebugEvent)}static onPaymentCompleteEvent(t){w.getInstance().dispatch(new D("Payment was successfully completed.",{event:t}),T.onDebugEvent)}static onPaymentFailedEvent(t){w.getInstance().dispatch(new D("Payment has failed.",{event:t}),T.onDebugEvent)}}class P{constructor(t,e,n){this.identifier=t,this.key=atob(e),this.expiresAt=n}getKey(){return this.key}isValid(){return!this.isExpired()}isExpired(){return new Date>this.expiresAt}}class I{static create(t,e,n){return new P(t,e,n)}static fromJson(t){let e=[];for(let n of t||[])e.push(this.create(n.identifier,n.public_key,n.expires_at));return e}}class A{constructor(t,e){this.publicKeys=t,this.refreshUrl=e}getUnexpiredPublicKey(){return new Promise((t,e)=>this.all().then(n=>{void 0!==n&&n.length>0&&t(n[0]),e(Error("Unable to fetch keys"))}).catch(t=>{throw t}))}all(){return new Promise((t,e)=>{let n=this.publicKeys.filter((function(t){return t.isValid()}));if(!(n.length>0))return this.refreshPublicKeys().then(e=>{this.publicKeys=e,t(e)}).catch(t=>{e(t)});t(n)})}refreshPublicKeys(){return Promise.race([fetch(this.refreshUrl).then((t,e)=>{if(t.ok)return t;e(Error("Unexpected response from server."))}).then(t=>t.json().catch(()=>{throw new Error("Invalid JSON returned.")})).then(t=>I.fromJson(t)).catch(()=>[]),new Promise((t,e)=>setTimeout(()=>e(new Error("timeout")),1e3))]).catch(t=>{console.log(t)})}}var M="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function O(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function B(t,e){return t(e={exports:{}},e.exports),e.exports}var V=O(B((function(t,e){!function(t){var e="0123456789abcdefghijklmnopqrstuvwxyz";function n(t){return e.charAt(t)}function r(t,e){return t&e}function i(t,e){return t|e}function s(t,e){return t^e}function a(t,e){return t&~e}function o(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function l(t){for(var e=0;0!=t;)t&=t-1,++e;return e}var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u="=";function h(t){var e,n,r="";for(e=0;e+3<=t.length;e+=3)n=parseInt(t.substring(e,e+3),16),r+=c.charAt(n>>6)+c.charAt(63&n);for(e+1==t.length?(n=parseInt(t.substring(e,e+1),16),r+=c.charAt(n<<2)):e+2==t.length&&(n=parseInt(t.substring(e,e+2),16),r+=c.charAt(n>>2)+c.charAt((3&n)<<4));(3&r.length)>0;)r+=u;return r}function d(t){var e,r="",i=0,s=0;for(e=0;e<t.length&&t.charAt(e)!=u;++e){var a=c.indexOf(t.charAt(e));a<0||(0==i?(r+=n(a>>2),s=3&a,i=1):1==i?(r+=n(s<<2|a>>4),s=15&a,i=2):2==i?(r+=n(s),r+=n(a>>2),s=3&a,i=3):(r+=n(s<<2|a>>4),r+=n(15&a),i=0))}return 1==i&&(r+=n(s<<2)),r}
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var p,f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function g(t,e){function n(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var m,v={decode:function(t){var e;if(void 0===p){var n="0123456789ABCDEF",r=" \f\n\r\t \u2028\u2029";for(p={},e=0;e<16;++e)p[n.charAt(e)]=e;for(n=n.toLowerCase(),e=10;e<16;++e)p[n.charAt(e)]=e;for(e=0;e<r.length;++e)p[r.charAt(e)]=-1}var i=[],s=0,a=0;for(e=0;e<t.length;++e){var o=t.charAt(e);if("="==o)break;if(-1!=(o=p[o])){if(void 0===o)throw new Error("Illegal character at offset "+e);s|=o,++a>=2?(i[i.length]=s,s=0,a=0):s<<=4}}if(a)throw new Error("Hex encoding incomplete: 4 bits missing");return i}},y={decode:function(t){var e;if(void 0===m){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="= \f\n\r\t \u2028\u2029";for(m=Object.create(null),e=0;e<64;++e)m[n.charAt(e)]=e;for(e=0;e<r.length;++e)m[r.charAt(e)]=-1}var i=[],s=0,a=0;for(e=0;e<t.length;++e){var o=t.charAt(e);if("="==o)break;if(-1!=(o=m[o])){if(void 0===o)throw new Error("Illegal character at offset "+e);s|=o,++a>=4?(i[i.length]=s>>16,i[i.length]=s>>8&255,i[i.length]=255&s,s=0,a=0):s<<=6}}switch(a){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:i[i.length]=s>>10;break;case 3:i[i.length]=s>>16,i[i.length]=s>>8&255}return i},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(t){var e=y.re.exec(t);if(e)if(e[1])t=e[1];else{if(!e[2])throw new Error("RegExp out of sync");t=e[2]}return y.decode(t)}},b=1e13,E=function(){function t(t){this.buf=[+t||0]}return t.prototype.mulAdd=function(t,e){var n,r,i=this.buf,s=i.length;for(n=0;n<s;++n)(r=i[n]*t+e)<b?e=0:r-=(e=0|r/b)*b,i[n]=r;e>0&&(i[n]=e)},t.prototype.sub=function(t){var e,n,r=this.buf,i=r.length;for(e=0;e<i;++e)(n=r[e]-t)<0?(n+=b,t=1):t=0,r[e]=n;for(;0===r[r.length-1];)r.pop()},t.prototype.toString=function(t){if(10!=(t||10))throw new Error("only base 10 is supported");for(var e=this.buf,n=e[e.length-1].toString(),r=e.length-2;r>=0;--r)n+=(b+e[r]).toString().substring(1);return n},t.prototype.valueOf=function(){for(var t=this.buf,e=0,n=t.length-1;n>=0;--n)e=e*b+t[n];return e},t.prototype.simplify=function(){var t=this.buf;return 1==t.length?t[0]:this},t}(),S="…",w=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,C=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;function x(t,e){return t.length>e&&(t=t.substring(0,e)+S),t}var D,T=function(){function t(e,n){this.hexDigits="0123456789ABCDEF",e instanceof t?(this.enc=e.enc,this.pos=e.pos):(this.enc=e,this.pos=n)}return t.prototype.get=function(t){if(void 0===t&&(t=this.pos++),t>=this.enc.length)throw new Error("Requesting byte offset "+t+" on a stream of length "+this.enc.length);return"string"==typeof this.enc?this.enc.charCodeAt(t):this.enc[t]},t.prototype.hexByte=function(t){return this.hexDigits.charAt(t>>4&15)+this.hexDigits.charAt(15&t)},t.prototype.hexDump=function(t,e,n){for(var r="",i=t;i<e;++i)if(r+=this.hexByte(this.get(i)),!0!==n)switch(15&i){case 7:r+="  ";break;case 15:r+="\n";break;default:r+=" "}return r},t.prototype.isASCII=function(t,e){for(var n=t;n<e;++n){var r=this.get(n);if(r<32||r>176)return!1}return!0},t.prototype.parseStringISO=function(t,e){for(var n="",r=t;r<e;++r)n+=String.fromCharCode(this.get(r));return n},t.prototype.parseStringUTF=function(t,e){for(var n="",r=t;r<e;){var i=this.get(r++);n+=i<128?String.fromCharCode(i):i>191&&i<224?String.fromCharCode((31&i)<<6|63&this.get(r++)):String.fromCharCode((15&i)<<12|(63&this.get(r++))<<6|63&this.get(r++))}return n},t.prototype.parseStringBMP=function(t,e){for(var n,r,i="",s=t;s<e;)n=this.get(s++),r=this.get(s++),i+=String.fromCharCode(n<<8|r);return i},t.prototype.parseTime=function(t,e,n){var r=this.parseStringISO(t,e),i=(n?w:C).exec(r);return i?(n&&(i[1]=+i[1],i[1]+=+i[1]<70?2e3:1900),r=i[1]+"-"+i[2]+"-"+i[3]+" "+i[4],i[5]&&(r+=":"+i[5],i[6]&&(r+=":"+i[6],i[7]&&(r+="."+i[7]))),i[8]&&(r+=" UTC","Z"!=i[8]&&(r+=i[8],i[9]&&(r+=":"+i[9]))),r):"Unrecognized time: "+r},t.prototype.parseInteger=function(t,e){for(var n,r=this.get(t),i=r>127,s=i?255:0,a="";r==s&&++t<e;)r=this.get(t);if(0==(n=e-t))return i?-1:0;if(n>4){for(a=r,n<<=3;0==(128&(+a^s));)a=+a<<1,--n;a="("+n+" bit)\n"}i&&(r-=256);for(var o=new E(r),l=t+1;l<e;++l)o.mulAdd(256,this.get(l));return a+o.toString()},t.prototype.parseBitString=function(t,e,n){for(var r=this.get(t),i="("+((e-t-1<<3)-r)+" bit)\n",s="",a=t+1;a<e;++a){for(var o=this.get(a),l=a==e-1?r:0,c=7;c>=l;--c)s+=o>>c&1?"1":"0";if(s.length>n)return i+x(s,n)}return i+s},t.prototype.parseOctetString=function(t,e,n){if(this.isASCII(t,e))return x(this.parseStringISO(t,e),n);var r=e-t,i="("+r+" byte)\n";r>(n/=2)&&(e=t+n);for(var s=t;s<e;++s)i+=this.hexByte(this.get(s));return r>n&&(i+=S),i},t.prototype.parseOID=function(t,e,n){for(var r="",i=new E,s=0,a=t;a<e;++a){var o=this.get(a);if(i.mulAdd(128,127&o),s+=7,!(128&o)){if(""===r)if((i=i.simplify())instanceof E)i.sub(80),r="2."+i.toString();else{var l=i<80?i<40?0:1:2;r=l+"."+(i-40*l)}else r+="."+i.toString();if(r.length>n)return x(r,n);i=new E,s=0}}return s>0&&(r+=".incomplete"),r},t}(),R=function(){function t(t,e,n,r,i){if(!(r instanceof P))throw new Error("Invalid tag value.");this.stream=t,this.header=e,this.length=n,this.tag=r,this.sub=i}return t.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},t.prototype.content=function(t){if(void 0===this.tag)return null;void 0===t&&(t=1/0);var e=this.posContent(),n=Math.abs(this.length);if(!this.tag.isUniversal())return null!==this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(e,e+n,t);switch(this.tag.tagNumber){case 1:return 0===this.stream.get(e)?"false":"true";case 2:return this.stream.parseInteger(e,e+n);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(e,e+n,t);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(e,e+n,t);case 6:return this.stream.parseOID(e,e+n,t);case 16:case 17:return null!==this.sub?"("+this.sub.length+" elem)":"(no elem)";case 12:return x(this.stream.parseStringUTF(e,e+n),t);case 18:case 19:case 20:case 21:case 22:case 26:return x(this.stream.parseStringISO(e,e+n),t);case 30:return x(this.stream.parseStringBMP(e,e+n),t);case 23:case 24:return this.stream.parseTime(e,e+n,23==this.tag.tagNumber)}return null},t.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(null===this.sub?"null":this.sub.length)+"]"},t.prototype.toPrettyString=function(t){void 0===t&&(t="");var e=t+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(e+="+"),e+=this.length,this.tag.tagConstructed?e+=" (constructed)":!this.tag.isUniversal()||3!=this.tag.tagNumber&&4!=this.tag.tagNumber||null===this.sub||(e+=" (encapsulates)"),e+="\n",null!==this.sub){t+="  ";for(var n=0,r=this.sub.length;n<r;++n)e+=this.sub[n].toPrettyString(t)}return e},t.prototype.posStart=function(){return this.stream.pos},t.prototype.posContent=function(){return this.stream.pos+this.header},t.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},t.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},t.decodeLength=function(t){var e=t.get(),n=127&e;if(n==e)return n;if(n>6)throw new Error("Length over 48 bits not supported at position "+(t.pos-1));if(0===n)return null;e=0;for(var r=0;r<n;++r)e=256*e+t.get();return e},t.prototype.getHexStringValue=function(){var t=this.toHexString(),e=2*this.header,n=2*this.length;return t.substr(e,n)},t.decode=function(e){var n;n=e instanceof T?e:new T(e,0);var r=new T(n),i=new P(n),s=t.decodeLength(n),a=n.pos,o=a-r.pos,l=null,c=function(){var e=[];if(null!==s){for(var r=a+s;n.pos<r;)e[e.length]=t.decode(n);if(n.pos!=r)throw new Error("Content size is not correct for container starting at offset "+a)}else try{for(;;){var i=t.decode(n);if(i.tag.isEOC())break;e[e.length]=i}s=a-n.pos}catch(t){throw new Error("Exception while decoding undefined length content: "+t)}return e};if(i.tagConstructed)l=c();else if(i.isUniversal()&&(3==i.tagNumber||4==i.tagNumber))try{if(3==i.tagNumber&&0!=n.get())throw new Error("BIT STRINGs with unused bits cannot encapsulate.");l=c();for(var u=0;u<l.length;++u)if(l[u].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch(t){l=null}if(null===l){if(null===s)throw new Error("We can't skip over an invalid tag with undefined length at offset "+a);n.pos=a+Math.abs(s)}return new t(r,o,s,i,l)},t}(),P=function(){function t(t){var e=t.get();if(this.tagClass=e>>6,this.tagConstructed=0!=(32&e),this.tagNumber=31&e,31==this.tagNumber){var n=new E;do{e=t.get(),n.mulAdd(128,127&e)}while(128&e);this.tagNumber=n.simplify()}}return t.prototype.isUniversal=function(){return 0===this.tagClass},t.prototype.isEOC=function(){return 0===this.tagClass&&0===this.tagNumber},t}(),I=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],A=(1<<26)/I[I.length-1],M=function(){function t(t,e,n){null!=t&&("number"==typeof t?this.fromNumber(t,e,n):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}return t.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var r,i=(1<<e)-1,s=!1,a="",o=this.t,l=this.DB-o*this.DB%e;if(o-- >0)for(l<this.DB&&(r=this[o]>>l)>0&&(s=!0,a=n(r));o>=0;)l<e?(r=(this[o]&(1<<l)-1)<<e-l,r|=this[--o]>>(l+=this.DB-e)):(r=this[o]>>(l-=e)&i,l<=0&&(l+=this.DB,--o)),r>0&&(s=!0),s&&(a+=n(r));return s?a:"0"},t.prototype.negate=function(){var e=F();return t.ZERO.subTo(this,e),e},t.prototype.abs=function(){return this.s<0?this.negate():this},t.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(0!=(e=n-t.t))return this.s<0?-e:e;for(;--n>=0;)if(0!=(e=this[n]-t[n]))return e;return 0},t.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+Z(this[this.t-1]^this.s&this.DM)},t.prototype.mod=function(e){var n=F();return this.abs().divRemTo(e,null,n),this.s<0&&n.compareTo(t.ZERO)>0&&e.subTo(n,n),n},t.prototype.modPowInt=function(t,e){var n;return n=t<256||e.isEven()?new B(e):new V(e),this.exp(t,n)},t.prototype.clone=function(){var t=F();return this.copyTo(t),t},t.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},t.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},t.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},t.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},t.prototype.toByteArray=function(){var t=this.t,e=[];e[0]=this.s;var n,r=this.DB-t*this.DB%8,i=0;if(t-- >0)for(r<this.DB&&(n=this[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this[t]&(1<<r)-1)<<8-r,n|=this[--t]>>(r+=this.DB-8)):(n=this[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),0!=(128&n)&&(n|=-256),0==i&&(128&this.s)!=(128&n)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e},t.prototype.equals=function(t){return 0==this.compareTo(t)},t.prototype.min=function(t){return this.compareTo(t)<0?this:t},t.prototype.max=function(t){return this.compareTo(t)>0?this:t},t.prototype.and=function(t){var e=F();return this.bitwiseTo(t,r,e),e},t.prototype.or=function(t){var e=F();return this.bitwiseTo(t,i,e),e},t.prototype.xor=function(t){var e=F();return this.bitwiseTo(t,s,e),e},t.prototype.andNot=function(t){var e=F();return this.bitwiseTo(t,a,e),e},t.prototype.not=function(){for(var t=F(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},t.prototype.shiftLeft=function(t){var e=F();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},t.prototype.shiftRight=function(t){var e=F();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},t.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+o(this[t]);return this.s<0?this.t*this.DB:-1},t.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,n=0;n<this.t;++n)t+=l(this[n]^e);return t},t.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},t.prototype.setBit=function(t){return this.changeBit(t,i)},t.prototype.clearBit=function(t){return this.changeBit(t,a)},t.prototype.flipBit=function(t){return this.changeBit(t,s)},t.prototype.add=function(t){var e=F();return this.addTo(t,e),e},t.prototype.subtract=function(t){var e=F();return this.subTo(t,e),e},t.prototype.multiply=function(t){var e=F();return this.multiplyTo(t,e),e},t.prototype.divide=function(t){var e=F();return this.divRemTo(t,e,null),e},t.prototype.remainder=function(t){var e=F();return this.divRemTo(t,null,e),e},t.prototype.divideAndRemainder=function(t){var e=F(),n=F();return this.divRemTo(t,e,n),[e,n]},t.prototype.modPow=function(t,e){var n,r,i=t.bitLength(),s=z(1);if(i<=0)return s;n=i<18?1:i<48?3:i<144?4:i<768?5:6,r=i<8?new B(e):e.isEven()?new L(e):new V(e);var a=[],o=3,l=n-1,c=(1<<n)-1;if(a[1]=r.convert(this),n>1){var u=F();for(r.sqrTo(a[1],u);o<=c;)a[o]=F(),r.mulTo(u,a[o-2],a[o]),o+=2}var h,d,p=t.t-1,f=!0,g=F();for(i=Z(t[p])-1;p>=0;){for(i>=l?h=t[p]>>i-l&c:(h=(t[p]&(1<<i+1)-1)<<l-i,p>0&&(h|=t[p-1]>>this.DB+i-l)),o=n;0==(1&h);)h>>=1,--o;if((i-=o)<0&&(i+=this.DB,--p),f)a[h].copyTo(s),f=!1;else{for(;o>1;)r.sqrTo(s,g),r.sqrTo(g,s),o-=2;o>0?r.sqrTo(s,g):(d=s,s=g,g=d),r.mulTo(g,a[h],s)}for(;p>=0&&0==(t[p]&1<<i);)r.sqrTo(s,g),d=s,s=g,g=d,--i<0&&(i=this.DB-1,--p)}return r.revert(s)},t.prototype.modInverse=function(e){var n=e.isEven();if(this.isEven()&&n||0==e.signum())return t.ZERO;for(var r=e.clone(),i=this.clone(),s=z(1),a=z(0),o=z(0),l=z(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),n?(s.isEven()&&a.isEven()||(s.addTo(this,s),a.subTo(e,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(e,a),a.rShiftTo(1,a);for(;i.isEven();)i.rShiftTo(1,i),n?(o.isEven()&&l.isEven()||(o.addTo(this,o),l.subTo(e,l)),o.rShiftTo(1,o)):l.isEven()||l.subTo(e,l),l.rShiftTo(1,l);r.compareTo(i)>=0?(r.subTo(i,r),n&&s.subTo(o,s),a.subTo(l,a)):(i.subTo(r,i),n&&o.subTo(s,o),l.subTo(a,l))}return 0!=i.compareTo(t.ONE)?t.ZERO:l.compareTo(e)>=0?l.subtract(e):l.signum()<0?(l.addTo(e,l),l.signum()<0?l.add(e):l):l},t.prototype.pow=function(t){return this.exp(t,new O)},t.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(e.compareTo(n)<0){var r=e;e=n,n=r}var i=e.getLowestSetBit(),s=n.getLowestSetBit();if(s<0)return e;for(i<s&&(s=i),s>0&&(e.rShiftTo(s,e),n.rShiftTo(s,n));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=n.getLowestSetBit())>0&&n.rShiftTo(i,n),e.compareTo(n)>=0?(e.subTo(n,e),e.rShiftTo(1,e)):(n.subTo(e,n),n.rShiftTo(1,n));return s>0&&n.lShiftTo(s,n),n},t.prototype.isProbablePrime=function(t){var e,n=this.abs();if(1==n.t&&n[0]<=I[I.length-1]){for(e=0;e<I.length;++e)if(n[0]==I[e])return!0;return!1}if(n.isEven())return!1;for(e=1;e<I.length;){for(var r=I[e],i=e+1;i<I.length&&r<A;)r*=I[i++];for(r=n.modInt(r);e<i;)if(r%I[e++]==0)return!1}return n.millerRabin(t)},t.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},t.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},t.prototype.fromString=function(e,n){var r;if(16==n)r=4;else if(8==n)r=3;else if(256==n)r=8;else if(2==n)r=1;else if(32==n)r=5;else{if(4!=n)return void this.fromRadix(e,n);r=2}this.t=0,this.s=0;for(var i=e.length,s=!1,a=0;--i>=0;){var o=8==r?255&+e[i]:Y(e,i);o<0?"-"==e.charAt(i)&&(s=!0):(s=!1,0==a?this[this.t++]=o:a+r>this.DB?(this[this.t-1]|=(o&(1<<this.DB-a)-1)<<a,this[this.t++]=o>>this.DB-a):this[this.t-1]|=o<<a,(a+=r)>=this.DB&&(a-=this.DB))}8==r&&0!=(128&+e[0])&&(this.s=-1,a>0&&(this[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),s&&t.ZERO.subTo(this,this)},t.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},t.prototype.dlShiftTo=function(t,e){var n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s},t.prototype.drShiftTo=function(t,e){for(var n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s},t.prototype.lShiftTo=function(t,e){for(var n=t%this.DB,r=this.DB-n,i=(1<<r)-1,s=Math.floor(t/this.DB),a=this.s<<n&this.DM,o=this.t-1;o>=0;--o)e[o+s+1]=this[o]>>r|a,a=(this[o]&i)<<n;for(o=s-1;o>=0;--o)e[o]=0;e[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()},t.prototype.rShiftTo=function(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)e.t=0;else{var r=t%this.DB,i=this.DB-r,s=(1<<r)-1;e[0]=this[n]>>r;for(var a=n+1;a<this.t;++a)e[a-n-1]|=(this[a]&s)<<i,e[a-n]=this[a]>>r;r>0&&(e[this.t-n-1]|=(this.s&s)<<i),e.t=this.t-n,e.clamp()}},t.prototype.subTo=function(t,e){for(var n=0,r=0,i=Math.min(t.t,this.t);n<i;)r+=this[n]-t[n],e[n++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;n<this.t;)r+=this[n],e[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<t.t;)r-=t[n],e[n++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=r<0?-1:0,r<-1?e[n++]=this.DV+r:r>0&&(e[n++]=r),e.t=n,e.clamp()},t.prototype.multiplyTo=function(e,n){var r=this.abs(),i=e.abs(),s=r.t;for(n.t=s+i.t;--s>=0;)n[s]=0;for(s=0;s<i.t;++s)n[s+r.t]=r.am(0,i[s],n,s,0,r.t);n.s=0,n.clamp(),this.s!=e.s&&t.ZERO.subTo(n,n)},t.prototype.squareTo=function(t){for(var e=this.abs(),n=t.t=2*e.t;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){var r=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,r,e.t-n-1))>=e.DV&&(t[n+e.t]-=e.DV,t[n+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()},t.prototype.divRemTo=function(e,n,r){var i=e.abs();if(!(i.t<=0)){var s=this.abs();if(s.t<i.t)return null!=n&&n.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=F());var a=F(),o=this.s,l=e.s,c=this.DB-Z(i[i.t-1]);c>0?(i.lShiftTo(c,a),s.lShiftTo(c,r)):(i.copyTo(a),s.copyTo(r));var u=a.t,h=a[u-1];if(0!=h){var d=h*(1<<this.F1)+(u>1?a[u-2]>>this.F2:0),p=this.FV/d,f=(1<<this.F1)/d,g=1<<this.F2,m=r.t,v=m-u,y=null==n?F():n;for(a.dlShiftTo(v,y),r.compareTo(y)>=0&&(r[r.t++]=1,r.subTo(y,r)),t.ONE.dlShiftTo(u,y),y.subTo(a,a);a.t<u;)a[a.t++]=0;for(;--v>=0;){var b=r[--m]==h?this.DM:Math.floor(r[m]*p+(r[m-1]+g)*f);if((r[m]+=a.am(0,b,r,v,0,u))<b)for(a.dlShiftTo(v,y),r.subTo(y,r);r[m]<--b;)r.subTo(y,r)}null!=n&&(r.drShiftTo(u,n),o!=l&&t.ZERO.subTo(n,n)),r.t=u,r.clamp(),c>0&&r.rShiftTo(c,r),o<0&&t.ZERO.subTo(r,r)}}},t.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},t.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},t.prototype.exp=function(e,n){if(e>4294967295||e<1)return t.ONE;var r=F(),i=F(),s=n.convert(this),a=Z(e)-1;for(s.copyTo(r);--a>=0;)if(n.sqrTo(r,i),(e&1<<a)>0)n.mulTo(i,s,r);else{var o=r;r=i,i=o}return n.revert(r)},t.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},t.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),n=Math.pow(t,e),r=z(n),i=F(),s=F(),a="";for(this.divRemTo(r,i,s);i.signum()>0;)a=(n+s.intValue()).toString(t).substr(1)+a,i.divRemTo(r,i,s);return s.intValue().toString(t)+a},t.prototype.fromRadix=function(e,n){this.fromInt(0),null==n&&(n=10);for(var r=this.chunkSize(n),i=Math.pow(n,r),s=!1,a=0,o=0,l=0;l<e.length;++l){var c=Y(e,l);c<0?"-"==e.charAt(l)&&0==this.signum()&&(s=!0):(o=n*o+c,++a>=r&&(this.dMultiply(i),this.dAddOffset(o,0),a=0,o=0))}a>0&&(this.dMultiply(Math.pow(n,a)),this.dAddOffset(o,0)),s&&t.ZERO.subTo(this,this)},t.prototype.fromNumber=function(e,n,r){if("number"==typeof n)if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(t.ONE.shiftLeft(e-1),i,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(n);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(t.ONE.shiftLeft(e-1),this);else{var s=[],a=7&e;s.length=1+(e>>3),n.nextBytes(s),a>0?s[0]&=(1<<a)-1:s[0]=0,this.fromString(s,256)}},t.prototype.bitwiseTo=function(t,e,n){var r,i,s=Math.min(t.t,this.t);for(r=0;r<s;++r)n[r]=e(this[r],t[r]);if(t.t<this.t){for(i=t.s&this.DM,r=s;r<this.t;++r)n[r]=e(this[r],i);n.t=this.t}else{for(i=this.s&this.DM,r=s;r<t.t;++r)n[r]=e(i,t[r]);n.t=t.t}n.s=e(this.s,t.s),n.clamp()},t.prototype.changeBit=function(e,n){var r=t.ONE.shiftLeft(e);return this.bitwiseTo(r,n,r),r},t.prototype.addTo=function(t,e){for(var n=0,r=0,i=Math.min(t.t,this.t);n<i;)r+=this[n]+t[n],e[n++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;n<this.t;)r+=this[n],e[n++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;n<t.t;)r+=t[n],e[n++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=r<0?-1:0,r>0?e[n++]=r:r<-1&&(e[n++]=this.DV+r),e.t=n,e.clamp()},t.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},t.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},t.prototype.multiplyLowerTo=function(t,e,n){var r=Math.min(this.t+t.t,e);for(n.s=0,n.t=r;r>0;)n[--r]=0;for(var i=n.t-this.t;r<i;++r)n[r+this.t]=this.am(0,t[r],n,r,0,this.t);for(i=Math.min(t.t,e);r<i;++r)this.am(0,t[r],n,r,0,e-r);n.clamp()},t.prototype.multiplyUpperTo=function(t,e,n){--e;var r=n.t=this.t+t.t-e;for(n.s=0;--r>=0;)n[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)n[this.t+r-e]=this.am(e-r,t[r],n,0,0,this.t+r-e);n.clamp(),n.drShiftTo(1,n)},t.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,n=this.s<0?t-1:0;if(this.t>0)if(0==e)n=this[0]%t;else for(var r=this.t-1;r>=0;--r)n=(e*n+this[r])%t;return n},t.prototype.millerRabin=function(e){var n=this.subtract(t.ONE),r=n.getLowestSetBit();if(r<=0)return!1;var i=n.shiftRight(r);(e=e+1>>1)>I.length&&(e=I.length);for(var s=F(),a=0;a<e;++a){s.fromInt(I[Math.floor(Math.random()*I.length)]);var o=s.modPow(i,this);if(0!=o.compareTo(t.ONE)&&0!=o.compareTo(n)){for(var l=1;l++<r&&0!=o.compareTo(n);)if(0==(o=o.modPowInt(2,this)).compareTo(t.ONE))return!1;if(0!=o.compareTo(n))return!1}}return!0},t.prototype.square=function(){var t=F();return this.squareTo(t),t},t.prototype.gcda=function(t,e){var n=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(n.compareTo(r)<0){var i=n;n=r,r=i}var s=n.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)e(n);else{s<a&&(a=s),a>0&&(n.rShiftTo(a,n),r.rShiftTo(a,r));var o=function(){(s=n.getLowestSetBit())>0&&n.rShiftTo(s,n),(s=r.getLowestSetBit())>0&&r.rShiftTo(s,r),n.compareTo(r)>=0?(n.subTo(r,n),n.rShiftTo(1,n)):(r.subTo(n,r),r.rShiftTo(1,r)),n.signum()>0?setTimeout(o,0):(a>0&&r.lShiftTo(a,r),setTimeout((function(){e(r)}),0))};setTimeout(o,10)}},t.prototype.fromNumberAsync=function(e,n,r,s){if("number"==typeof n)if(e<2)this.fromInt(1);else{this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(t.ONE.shiftLeft(e-1),i,this),this.isEven()&&this.dAddOffset(1,0);var a=this,o=function(){a.dAddOffset(2,0),a.bitLength()>e&&a.subTo(t.ONE.shiftLeft(e-1),a),a.isProbablePrime(n)?setTimeout((function(){s()}),0):setTimeout(o,0)};setTimeout(o,0)}else{var l=[],c=7&e;l.length=1+(e>>3),n.nextBytes(l),c>0?l[0]&=(1<<c)-1:l[0]=0,this.fromString(l,256)}},t}(),O=function(){function t(){}return t.prototype.convert=function(t){return t},t.prototype.revert=function(t){return t},t.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n)},t.prototype.sqrTo=function(t,e){t.squareTo(e)},t}(),B=function(){function t(t){this.m=t}return t.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},t.prototype.revert=function(t){return t},t.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},t.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},t.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},t}(),V=function(){function t(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}return t.prototype.convert=function(t){var e=F();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(M.ZERO)>0&&this.m.subTo(e,e),e},t.prototype.revert=function(t){var e=F();return t.copyTo(e),this.reduce(e),e},t.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=32767&t[e],r=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[n=e+this.m.t]+=this.m.am(0,r,t,e,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},t.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},t.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},t}(),L=function(){function t(t){this.m=t,this.r2=F(),this.q3=F(),M.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t)}return t.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=F();return t.copyTo(e),this.reduce(e),e},t.prototype.revert=function(t){return t},t.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},t.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},t.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},t}();function F(){return new M(null)}function k(t,e){return new M(t,e)}function N(t,e,n,r,i,s){for(;--s>=0;){var a=e*this[t++]+n[r]+i;i=Math.floor(a/67108864),n[r++]=67108863&a}return i}function j(t,e,n,r,i,s){for(var a=32767&e,o=e>>15;--s>=0;){var l=32767&this[t],c=this[t++]>>15,u=o*l+c*a;i=((l=a*l+((32767&u)<<15)+n[r]+(1073741823&i))>>>30)+(u>>>15)+o*c+(i>>>30),n[r++]=1073741823&l}return i}function _(t,e,n,r,i,s){for(var a=16383&e,o=e>>14;--s>=0;){var l=16383&this[t],c=this[t++]>>14,u=o*l+c*a;i=((l=a*l+((16383&u)<<14)+n[r]+i)>>28)+(u>>14)+o*c,n[r++]=268435455&l}return i}"Microsoft Internet Explorer"==navigator.appName?(M.prototype.am=j,D=30):"Netscape"!=navigator.appName?(M.prototype.am=N,D=26):(M.prototype.am=_,D=28),M.prototype.DB=D,M.prototype.DM=(1<<D)-1,M.prototype.DV=1<<D;var H=52;M.prototype.FV=Math.pow(2,H),M.prototype.F1=H-D,M.prototype.F2=2*D-H;var q,U,K=[];for(q="0".charCodeAt(0),U=0;U<=9;++U)K[q++]=U;for(q="a".charCodeAt(0),U=10;U<36;++U)K[q++]=U;for(q="A".charCodeAt(0),U=10;U<36;++U)K[q++]=U;function Y(t,e){var n=K[t.charCodeAt(e)];return null==n?-1:n}function z(t){var e=F();return e.fromInt(t),e}function Z(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}M.ZERO=z(0),M.ONE=z(1);var $=function(){function t(){this.i=0,this.j=0,this.S=[]}return t.prototype.init=function(t){var e,n,r;for(e=0;e<256;++e)this.S[e]=e;for(n=0,e=0;e<256;++e)n=n+this.S[e]+t[e%t.length]&255,r=this.S[e],this.S[e]=this.S[n],this.S[n]=r;this.i=0,this.j=0},t.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]},t}();function G(){return new $}var J,Q,W=256,X=null;if(null==X){X=[],Q=0;var tt=void 0;if(window.crypto&&window.crypto.getRandomValues){var et=new Uint32Array(256);for(window.crypto.getRandomValues(et),tt=0;tt<et.length;++tt)X[Q++]=255&et[tt]}var nt=function(t){if(this.count=this.count||0,this.count>=256||Q>=W)window.removeEventListener?window.removeEventListener("mousemove",nt,!1):window.detachEvent&&window.detachEvent("onmousemove",nt);else try{var e=t.x+t.y;X[Q++]=255&e,this.count+=1}catch(t){}};window.addEventListener?window.addEventListener("mousemove",nt,!1):window.attachEvent&&window.attachEvent("onmousemove",nt)}function rt(){if(null==J){for(J=G();Q<W;){var t=Math.floor(65536*Math.random());X[Q++]=255&t}for(J.init(X),Q=0;Q<X.length;++Q)X[Q]=0;Q=0}return J.next()}var it=function(){function t(){}return t.prototype.nextBytes=function(t){for(var e=0;e<t.length;++e)t[e]=rt()},t}();function st(t,e){if(e<t.length+22)return console.error("Message too long for RSA"),null;for(var n=e-t.length-6,r="",i=0;i<n;i+=2)r+="ff";return k("0001"+r+"00"+t,16)}function at(t,e){if(e<t.length+11)return console.error("Message too long for RSA"),null;for(var n=[],r=t.length-1;r>=0&&e>0;){var i=t.charCodeAt(r--);i<128?n[--e]=i:i>127&&i<2048?(n[--e]=63&i|128,n[--e]=i>>6|192):(n[--e]=63&i|128,n[--e]=i>>6&63|128,n[--e]=i>>12|224)}n[--e]=0;for(var s=new it,a=[];e>2;){for(a[0]=0;0==a[0];)s.nextBytes(a);n[--e]=a[0]}return n[--e]=2,n[--e]=0,new M(n)}var ot=function(){function t(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return t.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)},t.prototype.doPrivate=function(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),n=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(n)<0;)e=e.add(this.p);return e.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)},t.prototype.setPublic=function(t,e){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=k(t,16),this.e=parseInt(e,16)):console.error("Invalid RSA public key")},t.prototype.encrypt=function(t){var e=at(t,this.n.bitLength()+7>>3);if(null==e)return null;var n=this.doPublic(e);if(null==n)return null;var r=n.toString(16);return 0==(1&r.length)?r:"0"+r},t.prototype.setPrivate=function(t,e,n){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=k(t,16),this.e=parseInt(e,16),this.d=k(n,16)):console.error("Invalid RSA private key")},t.prototype.setPrivateEx=function(t,e,n,r,i,s,a,o){null!=t&&null!=e&&t.length>0&&e.length>0?(this.n=k(t,16),this.e=parseInt(e,16),this.d=k(n,16),this.p=k(r,16),this.q=k(i,16),this.dmp1=k(s,16),this.dmq1=k(a,16),this.coeff=k(o,16)):console.error("Invalid RSA private key")},t.prototype.generate=function(t,e){var n=new it,r=t>>1;this.e=parseInt(e,16);for(var i=new M(e,16);;){for(;this.p=new M(t-r,1,n),0!=this.p.subtract(M.ONE).gcd(i).compareTo(M.ONE)||!this.p.isProbablePrime(10););for(;this.q=new M(r,1,n),0!=this.q.subtract(M.ONE).gcd(i).compareTo(M.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var a=this.p.subtract(M.ONE),o=this.q.subtract(M.ONE),l=a.multiply(o);if(0==l.gcd(i).compareTo(M.ONE)){this.n=this.p.multiply(this.q),this.d=i.modInverse(l),this.dmp1=this.d.mod(a),this.dmq1=this.d.mod(o),this.coeff=this.q.modInverse(this.p);break}}},t.prototype.decrypt=function(t){var e=k(t,16),n=this.doPrivate(e);return null==n?null:lt(n,this.n.bitLength()+7>>3)},t.prototype.generateAsync=function(t,e,n){var r=new it,i=t>>1;this.e=parseInt(e,16);var s=new M(e,16),a=this,o=function(){var e=function(){if(a.p.compareTo(a.q)<=0){var t=a.p;a.p=a.q,a.q=t}var e=a.p.subtract(M.ONE),r=a.q.subtract(M.ONE),i=e.multiply(r);0==i.gcd(s).compareTo(M.ONE)?(a.n=a.p.multiply(a.q),a.d=s.modInverse(i),a.dmp1=a.d.mod(e),a.dmq1=a.d.mod(r),a.coeff=a.q.modInverse(a.p),setTimeout((function(){n()}),0)):setTimeout(o,0)},l=function(){a.q=F(),a.q.fromNumberAsync(i,1,r,(function(){a.q.subtract(M.ONE).gcda(s,(function(t){0==t.compareTo(M.ONE)&&a.q.isProbablePrime(10)?setTimeout(e,0):setTimeout(l,0)}))}))},c=function(){a.p=F(),a.p.fromNumberAsync(t-i,1,r,(function(){a.p.subtract(M.ONE).gcda(s,(function(t){0==t.compareTo(M.ONE)&&a.p.isProbablePrime(10)?setTimeout(l,0):setTimeout(c,0)}))}))};setTimeout(c,0)};setTimeout(o,0)},t.prototype.sign=function(t,e,n){var r=st(ut(n)+e(t).toString(),this.n.bitLength()/4);if(null==r)return null;var i=this.doPrivate(r);if(null==i)return null;var s=i.toString(16);return 0==(1&s.length)?s:"0"+s},t.prototype.verify=function(t,e,n){var r=k(e,16),i=this.doPublic(r);return null==i?null:ht(i.toString(16).replace(/^1f+00/,""))==n(t).toString()},t}();function lt(t,e){for(var n=t.toByteArray(),r=0;r<n.length&&0==n[r];)++r;if(n.length-r!=e-1||2!=n[r])return null;for(++r;0!=n[r];)if(++r>=n.length)return null;for(var i="";++r<n.length;){var s=255&n[r];s<128?i+=String.fromCharCode(s):s>191&&s<224?(i+=String.fromCharCode((31&s)<<6|63&n[r+1]),++r):(i+=String.fromCharCode((15&s)<<12|(63&n[r+1])<<6|63&n[r+2]),r+=2)}return i}var ct={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"};function ut(t){return ct[t]||""}function ht(t){for(var e in ct)if(ct.hasOwnProperty(e)){var n=ct[e],r=n.length;if(t.substr(0,r)==n)return t.substr(r)}return t}
/*!
    Copyright (c) 2011, Yahoo! Inc. All rights reserved.
    Code licensed under the BSD License:
    http://developer.yahoo.com/yui/license.html
    version: 2.9.0
    */var dt={};dt.lang={extend:function(t,e,n){if(!e||!t)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var r=function(){};if(r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e),n){var i;for(i in n)t.prototype[i]=n[i];var s=function(){},a=["toString","valueOf"];try{/MSIE/.test(navigator.userAgent)&&(s=function(t,e){for(i=0;i<a.length;i+=1){var n=a[i],r=e[n];"function"==typeof r&&r!=Object.prototype[n]&&(t[n]=r)}})}catch(t){}s(t.prototype,n)}}};
/**
     * @fileOverview
     * @name asn1-1.0.js
     * @author Kenji Urushima kenji.urushima@gmail.com
     * @version asn1 1.0.13 (2017-Jun-02)
     * @since jsrsasign 2.1
     * @license <a href="https://kjur.github.io/jsrsasign/license/">MIT License</a>
     */
var pt={};void 0!==pt.asn1&&pt.asn1||(pt.asn1={}),pt.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var e=t.toString(16);if("-"!=e.substr(0,1))e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e);else{var n=e.substr(1).length;n%2==1?n+=1:e.match(/^[0-7]/)||(n+=2);for(var r="",i=0;i<n;i++)r+="f";e=new M(r,16).xor(t).add(M.ONE).toString(16).replace(/^-/,"")}return e},this.getPEMStringFromHex=function(t,e){return hextopem(t,e)},this.newObject=function(t){var e=pt.asn1,n=e.DERBoolean,r=e.DERInteger,i=e.DERBitString,s=e.DEROctetString,a=e.DERNull,o=e.DERObjectIdentifier,l=e.DEREnumerated,c=e.DERUTF8String,u=e.DERNumericString,h=e.DERPrintableString,d=e.DERTeletexString,p=e.DERIA5String,f=e.DERUTCTime,g=e.DERGeneralizedTime,m=e.DERSequence,v=e.DERSet,y=e.DERTaggedObject,b=e.ASN1Util.newObject,E=Object.keys(t);if(1!=E.length)throw"key of param shall be only one.";var S=E[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+S+":"))throw"undefined key: "+S;if("bool"==S)return new n(t[S]);if("int"==S)return new r(t[S]);if("bitstr"==S)return new i(t[S]);if("octstr"==S)return new s(t[S]);if("null"==S)return new a(t[S]);if("oid"==S)return new o(t[S]);if("enum"==S)return new l(t[S]);if("utf8str"==S)return new c(t[S]);if("numstr"==S)return new u(t[S]);if("prnstr"==S)return new h(t[S]);if("telstr"==S)return new d(t[S]);if("ia5str"==S)return new p(t[S]);if("utctime"==S)return new f(t[S]);if("gentime"==S)return new g(t[S]);if("seq"==S){for(var w=t[S],C=[],x=0;x<w.length;x++){var D=b(w[x]);C.push(D)}return new m({array:C})}if("set"==S){for(w=t[S],C=[],x=0;x<w.length;x++)D=b(w[x]),C.push(D);return new v({array:C})}if("tag"==S){var T=t[S];if("[object Array]"===Object.prototype.toString.call(T)&&3==T.length){var R=b(T[2]);return new y({tag:T[0],explicit:T[1],obj:R})}var P={};if(void 0!==T.explicit&&(P.explicit=T.explicit),void 0!==T.tag&&(P.tag=T.tag),void 0===T.obj)throw"obj shall be specified for 'tag'.";return P.obj=b(T.obj),new y(P)}},this.jsonToASN1HEX=function(t){return this.newObject(t).getEncodedHex()}},pt.asn1.ASN1Util.oidHexToInt=function(t){for(var e="",n=parseInt(t.substr(0,2),16),r=(e=Math.floor(n/40)+"."+n%40,""),i=2;i<t.length;i+=2){var s=("00000000"+parseInt(t.substr(i,2),16).toString(2)).slice(-8);r+=s.substr(1,7),"0"==s.substr(0,1)&&(e=e+"."+new M(r,2).toString(10),r="")}return e},pt.asn1.ASN1Util.oidIntToHex=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",r=new M(t,10).toString(2),i=7-r.length%7;7==i&&(i=0);for(var s="",a=0;a<i;a++)s+="0";for(r=s+r,a=0;a<r.length-1;a+=7){var o=r.substr(a,7);a!=r.length-7&&(o="1"+o),n+=e(parseInt(o,2))}return n};if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var r="",i=t.split("."),s=40*parseInt(i[0])+parseInt(i[1]);r+=e(s),i.splice(0,2);for(var a=0;a<i.length;a++)r+=n(i[a]);return r},pt.asn1.ASN1Object=function(){var t="";this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+t.length+",v="+this.hV;var e=this.hV.length/2,n=e.toString(16);if(n.length%2==1&&(n="0"+n),e<128)return n;var r=n.length/2;if(r>15)throw"ASN.1 length too long to represent by 8x: n = "+e.toString(16);return(128+r).toString(16)+n},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},pt.asn1.DERAbstractString=function(t){pt.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(this.s)},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?this.setString(t):void 0!==t.str?this.setString(t.str):void 0!==t.hex&&this.setStringHex(t.hex))},dt.lang.extend(pt.asn1.DERAbstractString,pt.asn1.ASN1Object),pt.asn1.DERAbstractTime=function(t){pt.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(t){return utc=t.getTime()+6e4*t.getTimezoneOffset(),new Date(utc)},this.formatDate=function(t,e,n){var r=this.zeroPadding,i=this.localDateToUTC(t),s=String(i.getFullYear());"utc"==e&&(s=s.substr(2,2));var a=s+r(String(i.getMonth()+1),2)+r(String(i.getDate()),2)+r(String(i.getHours()),2)+r(String(i.getMinutes()),2)+r(String(i.getSeconds()),2);if(!0===n){var o=i.getMilliseconds();if(0!=o){var l=r(String(o),3);a=a+"."+(l=l.replace(/[0]+$/,""))}}return a+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=stohex(t)},this.setByDateValue=function(t,e,n,r,i,s){var a=new Date(Date.UTC(t,e-1,n,r,i,s,0));this.setByDate(a)},this.getFreshValueHex=function(){return this.hV}},dt.lang.extend(pt.asn1.DERAbstractTime,pt.asn1.ASN1Object),pt.asn1.DERAbstractStructured=function(t){pt.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,void 0!==t&&void 0!==t.array&&(this.asn1Array=t.array)},dt.lang.extend(pt.asn1.DERAbstractStructured,pt.asn1.ASN1Object),pt.asn1.DERBoolean=function(){pt.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},dt.lang.extend(pt.asn1.DERBoolean,pt.asn1.ASN1Object),pt.asn1.DERInteger=function(t){pt.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=pt.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new M(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.bigint?this.setByBigInteger(t.bigint):void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},dt.lang.extend(pt.asn1.DERInteger,pt.asn1.ASN1Object),pt.asn1.DERBitString=function(t){if(void 0!==t&&void 0!==t.obj){var e=pt.asn1.ASN1Util.newObject(t.obj);t.hex="00"+e.getEncodedHex()}pt.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},this.setUnusedBitsAndHexValue=function(t,e){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var n="0"+t;this.hTLV=null,this.isModified=!0,this.hV=n+e},this.setByBinaryString=function(t){var e=8-(t=t.replace(/0+$/,"")).length%8;8==e&&(e=0);for(var n=0;n<=e;n++)t+="0";var r="";for(n=0;n<t.length-1;n+=8){var i=t.substr(n,8),s=parseInt(i,2).toString(16);1==s.length&&(s="0"+s),r+=s}this.hTLV=null,this.isModified=!0,this.hV="0"+e+r},this.setByBooleanArray=function(t){for(var e="",n=0;n<t.length;n++)1==t[n]?e+="1":e+="0";this.setByBinaryString(e)},this.newFalseArray=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=!1;return e},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(t):void 0!==t.hex?this.setHexValueIncludingUnusedBits(t.hex):void 0!==t.bin?this.setByBinaryString(t.bin):void 0!==t.array&&this.setByBooleanArray(t.array))},dt.lang.extend(pt.asn1.DERBitString,pt.asn1.ASN1Object),pt.asn1.DEROctetString=function(t){if(void 0!==t&&void 0!==t.obj){var e=pt.asn1.ASN1Util.newObject(t.obj);t.hex=e.getEncodedHex()}pt.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},dt.lang.extend(pt.asn1.DEROctetString,pt.asn1.DERAbstractString),pt.asn1.DERNull=function(){pt.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},dt.lang.extend(pt.asn1.DERNull,pt.asn1.ASN1Object),pt.asn1.DERObjectIdentifier=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",r=new M(t,10).toString(2),i=7-r.length%7;7==i&&(i=0);for(var s="",a=0;a<i;a++)s+="0";for(r=s+r,a=0;a<r.length-1;a+=7){var o=r.substr(a,7);a!=r.length-7&&(o="1"+o),n+=e(parseInt(o,2))}return n};pt.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var r="",i=t.split("."),s=40*parseInt(i[0])+parseInt(i[1]);r+=e(s),i.splice(0,2);for(var a=0;a<i.length;a++)r+=n(i[a]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=r},this.setValueName=function(t){var e=pt.asn1.x509.OID.name2oid(t);if(""===e)throw"DERObjectIdentifier oidName undefined: "+t;this.setValueOidString(e)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t):void 0!==t.oid?this.setValueOidString(t.oid):void 0!==t.hex?this.setValueHex(t.hex):void 0!==t.name&&this.setValueName(t.name))},dt.lang.extend(pt.asn1.DERObjectIdentifier,pt.asn1.ASN1Object),pt.asn1.DEREnumerated=function(t){pt.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=pt.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new M(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},dt.lang.extend(pt.asn1.DEREnumerated,pt.asn1.ASN1Object),pt.asn1.DERUTF8String=function(t){pt.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},dt.lang.extend(pt.asn1.DERUTF8String,pt.asn1.DERAbstractString),pt.asn1.DERNumericString=function(t){pt.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},dt.lang.extend(pt.asn1.DERNumericString,pt.asn1.DERAbstractString),pt.asn1.DERPrintableString=function(t){pt.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},dt.lang.extend(pt.asn1.DERPrintableString,pt.asn1.DERAbstractString),pt.asn1.DERTeletexString=function(t){pt.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},dt.lang.extend(pt.asn1.DERTeletexString,pt.asn1.DERAbstractString),pt.asn1.DERIA5String=function(t){pt.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},dt.lang.extend(pt.asn1.DERIA5String,pt.asn1.DERAbstractString),pt.asn1.DERUTCTime=function(t){pt.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date))},dt.lang.extend(pt.asn1.DERUTCTime,pt.asn1.DERAbstractTime),pt.asn1.DERGeneralizedTime=function(t){pt.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.withMillis=!1,this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date),!0===t.millis&&(this.withMillis=!0))},dt.lang.extend(pt.asn1.DERGeneralizedTime,pt.asn1.DERAbstractTime),pt.asn1.DERSequence=function(t){pt.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++)t+=this.asn1Array[e].getEncodedHex();return this.hV=t,this.hV}},dt.lang.extend(pt.asn1.DERSequence,pt.asn1.DERAbstractStructured),pt.asn1.DERSet=function(t){pt.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var n=this.asn1Array[e];t.push(n.getEncodedHex())}return 1==this.sortFlag&&t.sort(),this.hV=t.join(""),this.hV},void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},dt.lang.extend(pt.asn1.DERSet,pt.asn1.DERAbstractStructured),pt.asn1.DERTaggedObject=function(t){pt.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,n){this.hT=e,this.isExplicit=t,this.asn1Object=n,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=n.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.tag&&(this.hT=t.tag),void 0!==t.explicit&&(this.isExplicit=t.explicit),void 0!==t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},dt.lang.extend(pt.asn1.DERTaggedObject,pt.asn1.ASN1Object);var ft=function(t){function e(n){var r=t.call(this)||this;return n&&("string"==typeof n?r.parseKey(n):(e.hasPrivateKeyProperty(n)||e.hasPublicKeyProperty(n))&&r.parsePropertiesFrom(n)),r}return g(e,t),e.prototype.parseKey=function(t){try{var e=0,n=0,r=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/.test(t)?v.decode(t):y.unarmor(t),i=R.decode(r);if(3===i.sub.length&&(i=i.sub[2].sub[0]),9===i.sub.length){e=i.sub[1].getHexStringValue(),this.n=k(e,16),n=i.sub[2].getHexStringValue(),this.e=parseInt(n,16);var s=i.sub[3].getHexStringValue();this.d=k(s,16);var a=i.sub[4].getHexStringValue();this.p=k(a,16);var o=i.sub[5].getHexStringValue();this.q=k(o,16);var l=i.sub[6].getHexStringValue();this.dmp1=k(l,16);var c=i.sub[7].getHexStringValue();this.dmq1=k(c,16);var u=i.sub[8].getHexStringValue();this.coeff=k(u,16)}else{if(2!==i.sub.length)return!1;var h=i.sub[1].sub[0];e=h.sub[0].getHexStringValue(),this.n=k(e,16),n=h.sub[1].getHexStringValue(),this.e=parseInt(n,16)}return!0}catch(t){return!1}},e.prototype.getPrivateBaseKey=function(){var t={array:[new pt.asn1.DERInteger({int:0}),new pt.asn1.DERInteger({bigint:this.n}),new pt.asn1.DERInteger({int:this.e}),new pt.asn1.DERInteger({bigint:this.d}),new pt.asn1.DERInteger({bigint:this.p}),new pt.asn1.DERInteger({bigint:this.q}),new pt.asn1.DERInteger({bigint:this.dmp1}),new pt.asn1.DERInteger({bigint:this.dmq1}),new pt.asn1.DERInteger({bigint:this.coeff})]};return new pt.asn1.DERSequence(t).getEncodedHex()},e.prototype.getPrivateBaseKeyB64=function(){return h(this.getPrivateBaseKey())},e.prototype.getPublicBaseKey=function(){var t=new pt.asn1.DERSequence({array:[new pt.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new pt.asn1.DERNull]}),e=new pt.asn1.DERSequence({array:[new pt.asn1.DERInteger({bigint:this.n}),new pt.asn1.DERInteger({int:this.e})]}),n=new pt.asn1.DERBitString({hex:"00"+e.getEncodedHex()});return new pt.asn1.DERSequence({array:[t,n]}).getEncodedHex()},e.prototype.getPublicBaseKeyB64=function(){return h(this.getPublicBaseKey())},e.wordwrap=function(t,e){if(!t)return t;var n="(.{1,"+(e=e||64)+"})( +|$\n?)|(.{1,"+e+"})";return t.match(RegExp(n,"g")).join("\n")},e.prototype.getPrivateKey=function(){var t="-----BEGIN RSA PRIVATE KEY-----\n";return t+=e.wordwrap(this.getPrivateBaseKeyB64())+"\n",t+="-----END RSA PRIVATE KEY-----"},e.prototype.getPublicKey=function(){var t="-----BEGIN PUBLIC KEY-----\n";return t+=e.wordwrap(this.getPublicBaseKeyB64())+"\n",t+="-----END PUBLIC KEY-----"},e.hasPublicKeyProperty=function(t){return(t=t||{}).hasOwnProperty("n")&&t.hasOwnProperty("e")},e.hasPrivateKeyProperty=function(t){return(t=t||{}).hasOwnProperty("n")&&t.hasOwnProperty("e")&&t.hasOwnProperty("d")&&t.hasOwnProperty("p")&&t.hasOwnProperty("q")&&t.hasOwnProperty("dmp1")&&t.hasOwnProperty("dmq1")&&t.hasOwnProperty("coeff")},e.prototype.parsePropertiesFrom=function(t){this.n=t.n,this.e=t.e,t.hasOwnProperty("d")&&(this.d=t.d,this.p=t.p,this.q=t.q,this.dmp1=t.dmp1,this.dmq1=t.dmq1,this.coeff=t.coeff)},e}(ot),gt=function(){function t(t){t=t||{},this.default_key_size=parseInt(t.default_key_size,10)||1024,this.default_public_exponent=t.default_public_exponent||"010001",this.log=t.log||!1,this.key=null}return t.prototype.setKey=function(t){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new ft(t)},t.prototype.setPrivateKey=function(t){this.setKey(t)},t.prototype.setPublicKey=function(t){this.setKey(t)},t.prototype.decrypt=function(t){try{return this.getKey().decrypt(d(t))}catch(t){return!1}},t.prototype.encrypt=function(t){try{return h(this.getKey().encrypt(t))}catch(t){return!1}},t.prototype.sign=function(t,e,n){try{return h(this.getKey().sign(t,e,n))}catch(t){return!1}},t.prototype.verify=function(t,e,n){try{return this.getKey().verify(t,d(e),n)}catch(t){return!1}},t.prototype.getKey=function(t){if(!this.key){if(this.key=new ft,t&&"[object Function]"==={}.toString.call(t))return void this.key.generateAsync(this.default_key_size,this.default_public_exponent,t);this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},t.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},t.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},t.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},t.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},t.version="3.0.0-rc.1",t}();window.JSEncrypt=gt,t.JSEncrypt=gt,t.default=gt,Object.defineProperty(t,"__esModule",{value:!0})}(e)})));class L{encrypt(t,e){let n=new V;return n.setPublicKey(t),n.encrypt(e)}}class F extends x{}class k{constructor(t){this.data=t}getType(){return this.data.type}}class N extends k{constructor(t){super(t)}getStatus(){return Boolean(this.data.status)}getResult(){return Boolean(this.data.result)}getChallengePayload(){return this.data.challengePayload}getFlow(){return this.data.flow}getAcsUrl(){return this.data.acsUrl}getTermUrl(){return this.data.termUrl}getPaReq(){return this.data.paReq}getMd(){return btoa(this.data.md)}}class j extends k{constructor(t){super(t)}getStatus(){return this.data.status}getMessage(){return this.data.message}getLevel(){return this.data.level}}class _ extends k{constructor(t){super(t)}getStatus(){return this.data.status}}class H{getHandleCaptureResponse(t){switch(t.type){case"error":return new j(t);case"transaction":return new _(t);case"challenge":return new N(t)}if("transaction"in t)return t.transaction.type="transaction",new _(t.transaction);throw new Error("Unable to determine type for received response")}}class q extends x{constructor(t,e={}){super(t,e),this.recovered=!1,this.recoverObject=null,this.recoverParameters=null,this.recoverEvent=null}static fromException(t,e){return new q(t,e)}static fromEventWithException(t,e,n){return new q(e,Object.assign({},{event:e},n))}getRecoveredObject(){return this.recoverObject}getRecoveredParameters(){return this.recoverParameters}getRecoveredEvent(){return this.recoverEvent}hasRecovered(){return this.recovered}recover(t,e={},n=null){this.recovered=!0,this.recoverObject=t,this.recoverParameters=e,this.recoverEvent=n}}class U extends x{getCurrentState(){return y.getInstance()}}class K extends C{static onResponseEvent(t){let e=new H;try{t.setParameter("response",e.getHandleCaptureResponse(t.subject));let n=y.getInstance().getElementFromReference(m.form);w.getInstance().dispatch(new U(n,{validation:null,state:{loading:!1}}),T.onStateChangeEvent)}catch(e){let n=q.fromEventWithException(t,e,{});w.getInstance().dispatch(n,T.onExceptionEvent),n.hasRecovered()&&(t.setParameter("response",n.getRecoveredObject()),n.stopPropagation()),t.stopPropagation()}}}class Y extends C{static onResponseEvent(t){t.subject=t.subject.json()}}var z={visa:{niceType:"Visa",type:"visa",patterns:[4],gaps:[4,8,12],lengths:[16,18,19],code:{name:"CVV",size:3}},mastercard:{niceType:"Mastercard",type:"mastercard",patterns:[[51,55],[2221,2229],[223,229],[23,26],[270,271],2720],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},"american-express":{niceType:"American Express",type:"american-express",patterns:[34,37],gaps:[4,10],lengths:[15],code:{name:"CID",size:4}},"diners-club":{niceType:"Diners Club",type:"diners-club",patterns:[[300,305],36,38,39],gaps:[4,10],lengths:[14,16,19],code:{name:"CVV",size:3}},discover:{niceType:"Discover",type:"discover",patterns:[6011,[644,649],65],gaps:[4,8,12],lengths:[16,19],code:{name:"CID",size:3}},jcb:{niceType:"JCB",type:"jcb",patterns:[2131,1800,[3528,3589]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVV",size:3}},unionpay:{niceType:"UnionPay",type:"unionpay",patterns:[620,[624,626],[62100,62182],[62184,62187],[62185,62197],[62200,62205],[622010,622999],622018,[622019,622999],[62207,62209],[622126,622925],[623,626],6270,6272,6276,[627700,627779],[627781,627799],[6282,6289],6291,6292,810,[8110,8131],[8132,8151],[8152,8163],[8164,8171]],gaps:[4,8,12],lengths:[14,15,16,17,18,19],code:{name:"CVN",size:3}},maestro:{niceType:"Maestro",type:"maestro",patterns:[493698,[5e5,504174],[504176,506698],[506779,508999],[56,59],63,67,6],gaps:[4,8,12],lengths:[12,13,14,15,16,17,18,19],code:{name:"CVC",size:3}},elo:{niceType:"Elo",type:"elo",patterns:[401178,401179,438935,457631,457632,431274,451416,457393,504175,[506699,506778],[509e3,509999],627780,636297,636368,[650031,650033],[650035,650051],[650405,650439],[650485,650538],[650541,650598],[650700,650718],[650720,650727],[650901,650978],[651652,651679],[655e3,655019],[655021,655058]],gaps:[4,8,12],lengths:[16],code:{name:"CVE",size:3}},mir:{niceType:"Mir",type:"mir",patterns:[[2200,2204]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVP2",size:3}},hiper:{niceType:"Hiper",type:"hiper",patterns:[637095,637568,637599,637609,637612],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},hipercard:{niceType:"Hipercard",type:"hipercard",patterns:[606282],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}}},Z=B((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.clone=void 0,e.clone=function(t){return t?JSON.parse(JSON.stringify(t)):null}}));O(Z);Z.clone;var $=B((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.matches=void 0,e.matches=function(t,e){return Array.isArray(e)?function(t,e,n){var r=String(e).length,i=t.substr(0,r),s=parseInt(i,10);return e=parseInt(String(e).substr(0,i.length),10),n=parseInt(String(n).substr(0,i.length),10),s>=e&&s<=n}(t,e[0],e[1]):function(t,e){return(e=String(e)).substring(0,t.length)===t.substring(0,e.length)}(t,e)}}));O($);$.matches;var G=B((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.addMatchingCardsToResults=void 0,e.addMatchingCardsToResults=function(t,e,n){var r,i;for(r=0;r<e.patterns.length;r++){var s=e.patterns[r];if($.matches(t,s)){var a=Z.clone(e);i=Array.isArray(s)?String(s[0]).length:String(s).length,t.length>=i&&(a.matchStrength=i),n.push(a);break}}}}));O(G);G.addMatchingCardsToResults;var J=B((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isValidInputType=void 0,e.isValidInputType=function(t){return"string"==typeof t||t instanceof String}}));O(J);J.isValidInputType;var Q=B((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.findBestMatch=void 0,e.findBestMatch=function(t){return function(t){var e=t.filter((function(t){return t.matchStrength})).length;return e>0&&e===t.length}(t)?t.reduce((function(t,e){return t?Number(t.matchStrength)<Number(e.matchStrength)?e:t:e})):null}}));O(Q);Q.findBestMatch;var W=M&&M.__assign||function(){return(W=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},X={},tt={VISA:"visa",MASTERCARD:"mastercard",AMERICAN_EXPRESS:"american-express",DINERS_CLUB:"diners-club",DISCOVER:"discover",JCB:"jcb",UNIONPAY:"unionpay",MAESTRO:"maestro",ELO:"elo",MIR:"mir",HIPER:"hiper",HIPERCARD:"hipercard"},et=[tt.VISA,tt.MASTERCARD,tt.AMERICAN_EXPRESS,tt.DINERS_CLUB,tt.DISCOVER,tt.JCB,tt.UNIONPAY,tt.MAESTRO,tt.ELO,tt.MIR,tt.HIPER,tt.HIPERCARD],nt=Z.clone(et);function rt(t){return X[t]||z[t]}function it(t,e){void 0===e&&(e=!1);var n=nt.indexOf(t);if(!e&&-1===n)throw new Error('"'+t+'" is not a supported card type.');return n}function st(t){var e=[];if(!J.isValidInputType(t))return e;if(0===t.length)return nt.map((function(t){return Z.clone(rt(t))}));nt.forEach((function(n){var r=rt(n);G.addMatchingCardsToResults(t,r,e)}));var n=Q.findBestMatch(e);return n?[n]:e}st.getTypeInfo=function(t){return Z.clone(rt(t))},st.removeCard=function(t){var e=it(t);nt.splice(e,1)},st.addCard=function(t){var e=it(t.type,!0);X[t.type]=t,-1===e&&nt.push(t.type)},st.updateCard=function(t,e){var n=X[t]||z[t];if(!n)throw new Error('"'+t+"\" is not a recognized type. Use `addCard` instead.'");if(e.type&&n.type!==e.type)throw new Error("Cannot overwrite type parameter.");var r=Z.clone(n);r=W(W({},r),e),X[r.type]=r},st.changeOrder=function(t,e){var n=it(t);nt.splice(n,1),nt.splice(e,0,t)},st.resetModifications=function(){nt=Z.clone(et),X={}},st.types=tt;var at=st,ot=B((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.cardholderName=void 0;var n=/^[\d\s-]*$/;function r(t,e){return{isValid:t,isPotentiallyValid:e}}e.cardholderName=function(t){return"string"!=typeof t?r(!1,!1):0===t.length?r(!1,!0):t.length>255?r(!1,!1):n.test(t)?r(!1,!0):r(!0,!0)}}));O(ot);ot.cardholderName;var lt=function(t){for(var e,n=0,r=!1,i=t.length-1;i>=0;)e=parseInt(t.charAt(i),10),r&&(e*=2)>9&&(e=e%10+1),r=!r,n+=e,i--;return n%10==0},ct=B((function(t,e){function n(t,e,n){return{card:t,isPotentiallyValid:e,isValid:n}}Object.defineProperty(e,"__esModule",{value:!0}),e.cardNumber=void 0,e.cardNumber=function(t,e){var r,i;if(void 0===e&&(e={}),"string"!=typeof t&&"number"!=typeof t)return n(null,!1,!1);var s=String(t).replace(/-|\s/g,"");if(!/^\d*$/.test(s))return n(null,!1,!1);var a=at(s);if(0===a.length)return n(null,!1,!1);if(1!==a.length)return n(null,!0,!1);var o=a[0];if(e.maxLength&&s.length>e.maxLength)return n(o,!1,!1);r=o.type===at.types.UNIONPAY&&!0!==e.luhnValidateUnionPay||lt(s),i=Math.max.apply(null,o.lengths),e.maxLength&&(i=Math.min(e.maxLength,i));for(var l=0;l<o.lengths.length;l++)if(o.lengths[l]===s.length)return n(o,s.length<i||r,r);return n(o,s.length<i,!1)}}));O(ct);ct.cardNumber;var ut=B((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.expirationYear=void 0;function n(t,e,n){return{isValid:t,isPotentiallyValid:e,isCurrentYear:n||!1}}e.expirationYear=function(t,e){var r;if(void 0===e&&(e=19),"string"!=typeof t)return n(!1,!1);if(""===t.replace(/\s/g,""))return n(!1,!0);if(!/^\d*$/.test(t))return n(!1,!1);var i=t.length;if(i<2)return n(!1,!0);var s=(new Date).getFullYear();if(3===i)return n(!1,t.slice(0,2)===String(s).slice(0,2));if(i>4)return n(!1,!1);var a=parseInt(t,10),o=Number(String(s).substr(2,2)),l=!1;return 2===i?(r=o===a,l=a>=o&&a<=o+e):4===i&&(r=s===a,l=a>=s&&a<=s+e),n(l,l,r)}}));O(ut);ut.expirationYear;var ht=B((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isArray=void 0,e.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}}));O(ht);ht.isArray;var dt=B((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.parseDate=void 0,e.parseDate=function(t){var e;if(/^\d{4}-\d{1,2}$/.test(t)?e=t.split("-").reverse():/\//.test(t)?e=t.split(/\s*\/\s*/g):/\s/.test(t)&&(e=t.split(/ +/g)),ht.isArray(e))return{month:e[0]||"",year:e.slice(1).join()};var n,r,i,s=(n=t,0===(i=Number(n[0]))?2:i>1||1===i&&Number(n[1])>2?1:1===i?(r=n.substr(1),ut.expirationYear(r).isPotentiallyValid?1:2):5===n.length?1:n.length>5?2:1),a=t.substr(0,s);return{month:a,year:t.substr(a.length)}}}));O(dt);dt.parseDate;var pt=B((function(t,e){function n(t,e,n){return{isValid:t,isPotentiallyValid:e,isValidForThisYear:n||!1}}Object.defineProperty(e,"__esModule",{value:!0}),e.expirationMonth=void 0,e.expirationMonth=function(t){var e=(new Date).getMonth()+1;if("string"!=typeof t)return n(!1,!1);if(""===t.replace(/\s/g,"")||"0"===t)return n(!1,!0);if(!/^\d*$/.test(t))return n(!1,!1);var r=parseInt(t,10);if(isNaN(Number(t)))return n(!1,!1);var i=r>0&&r<13;return n(i,i,i&&r>=e)}}));O(pt);pt.expirationMonth;var ft=B((function(t,e){var n=M&&M.__assign||function(){return(n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function r(t,e,n,r){return{isValid:t,isPotentiallyValid:e,month:n,year:r}}Object.defineProperty(e,"__esModule",{value:!0}),e.expirationDate=void 0,e.expirationDate=function(t,e){var i;if("string"==typeof t)t=t.replace(/^(\d\d) (\d\d(\d\d)?)$/,"$1/$2"),i=dt.parseDate(String(t));else{if(null===t||"object"!=typeof t)return r(!1,!1,null,null);var s=n({},t);i={month:String(s.month),year:String(s.year)}}var a=pt.expirationMonth(i.month),o=ut.expirationYear(i.year,e);if(a.isValid){if(o.isCurrentYear){var l=a.isValidForThisYear;return r(l,l,i.month,i.year)}if(o.isValid)return r(!0,!0,i.month,i.year)}return a.isPotentiallyValid&&o.isPotentiallyValid?r(!1,!0,null,null):r(!1,!1,null,null)}}));O(ft);ft.expirationDate;var gt=B((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.cvv=void 0;function n(t,e){return{isValid:t,isPotentiallyValid:e}}e.cvv=function(t,e){return void 0===e&&(e=3),e=e instanceof Array?e:[e],"string"!=typeof t?n(!1,!1):/^\d*$/.test(t)?function(t,e){for(var n=0;n<t.length;n++)if(e===t[n])return!0;return!1}(e,t.length)?n(!0,!0):t.length<Math.min.apply(null,e)?n(!1,!0):t.length>function(t){for(var e=3,n=0;n<t.length;n++)e=t[n]>e?t[n]:e;return e}(e)?n(!1,!1):n(!0,!0):n(!1,!1)}}));O(gt);gt.cvv;var mt=B((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.postalCode=void 0;function n(t,e){return{isValid:t,isPotentiallyValid:e}}e.postalCode=function(t,e){void 0===e&&(e={});var r=e.minLength||3;return"string"!=typeof t?n(!1,!1):t.length<r?n(!1,!0):n(!0,!0)}}));O(mt);mt.postalCode;var vt=O(B((function(t){var e=M&&M.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),n=M&&M.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r={creditCardType:(M&&M.__importStar||function(t){if(t&&t.__esModule)return t;var r={};if(null!=t)for(var i in t)"default"!==i&&Object.hasOwnProperty.call(t,i)&&e(r,t,i);return n(r,t),r})(at),cardholderName:ot.cardholderName,number:ct.cardNumber,expirationDate:ft.expirationDate,expirationMonth:pt.expirationMonth,expirationYear:ut.expirationYear,cvv:gt.cvv,postalCode:mt.postalCode};t.exports=r})));class yt extends C{static onStateChangeEvent(t){let e=y.getInstance();if("state"in t.parameters){e.updateState(t.parameters.state);let n={inputComplete:yt.inputComplete(e),formReadyForSubmission:yt.readyForSubmission(e)};e.updateState(n)}}static onPaymentCompleteEvent(t){yt.onStateChangeEvent(new U(t,{validation:null,state:{loading:!1}}))}static onPaymentFailedEvent(t){yt.onStateChangeEvent(new U(t,{validation:null,state:{loading:!1}}))}static readyForSubmission(t){return yt.inputComplete(t)}static inputComplete(t){return t.getStateParameter("cardHolderInputComplete")&&t.getStateParameter("cardNumberInputComplete")&&t.getStateParameter("cardCvvInputComplete")&&t.getStateParameter("cardExpiryMonthInputComplete")&&t.getStateParameter("cardExpiryYearInputComplete")}}class bt extends x{}class Et{constructor(t,e={}){this.response=t,this.config=Object.assign({},{onShow:()=>{w.getInstance().dispatch(new U(null,{state:{modalOpen:!0}}),T.onStateChangeEvent)},onClose:()=>{let t={modalOpen:!1};y.getInstance().isFormSubmitted()&&(t.formSubmitted=!1),w.getInstance().dispatch(new U(null,{state:t}),T.onStateChangeEvent);let e=new bt(this);w.getInstance().dispatch(e,T.onModalCloseEvent)},awaitOpenAnimation:!0,awaitCloseAnimation:!0},e)}getConfig(){return this.config}}class St extends Et{render(t={}){return""+this.response.getMessage()}}function wt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ct(t){return function(t){if(Array.isArray(t))return xt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return xt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xt(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Dt=function(){var t=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden])","iframe","object","embed","[contenteditable]",'[tabindex]:not([tabindex^="-"])'],e=function(){function e(t){var n=t.targetModal,r=t.triggers,i=void 0===r?[]:r,s=t.onShow,a=void 0===s?function(){}:s,o=t.onClose,l=void 0===o?function(){}:o,c=t.openTrigger,u=void 0===c?"data-micromodal-trigger":c,h=t.closeTrigger,d=void 0===h?"data-micromodal-close":h,p=t.openClass,f=void 0===p?"is-open":p,g=t.disableScroll,m=void 0!==g&&g,v=t.disableFocus,y=void 0!==v&&v,b=t.awaitCloseAnimation,E=void 0!==b&&b,S=t.awaitOpenAnimation,w=void 0!==S&&S,C=t.debugMode,x=void 0!==C&&C;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.modal=document.getElementById(n),this.config={debugMode:x,disableScroll:m,openTrigger:u,closeTrigger:d,openClass:f,onShow:a,onClose:l,awaitCloseAnimation:E,awaitOpenAnimation:w,disableFocus:y},i.length>0&&this.registerTriggers.apply(this,Ct(i)),this.onClick=this.onClick.bind(this),this.onKeydown=this.onKeydown.bind(this)}var n,r,i;return n=e,(r=[{key:"registerTriggers",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.filter(Boolean).forEach((function(e){e.addEventListener("click",(function(e){return t.showModal(e)}))}))}},{key:"showModal",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.activeElement=document.activeElement,this.modal.setAttribute("aria-hidden","false"),this.modal.classList.add(this.config.openClass),this.scrollBehaviour("disable"),this.addEventListeners(),this.config.awaitOpenAnimation){var n=function e(){t.modal.removeEventListener("animationend",e,!1),t.setFocusToFirstNode()};this.modal.addEventListener("animationend",n,!1)}else this.setFocusToFirstNode();this.config.onShow(this.modal,this.activeElement,e)}},{key:"closeModal",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.modal;if(this.modal.setAttribute("aria-hidden","true"),this.removeEventListeners(),this.scrollBehaviour("enable"),this.activeElement&&this.activeElement.focus&&this.activeElement.focus(),this.config.onClose(this.modal,this.activeElement,t),this.config.awaitCloseAnimation){var n=this.config.openClass;this.modal.addEventListener("animationend",(function t(){e.classList.remove(n),e.removeEventListener("animationend",t,!1)}),!1)}else e.classList.remove(this.config.openClass)}},{key:"closeModalById",value:function(t){this.modal=document.getElementById(t),this.modal&&this.closeModal()}},{key:"scrollBehaviour",value:function(t){if(this.config.disableScroll){var e=document.querySelector("body");switch(t){case"enable":Object.assign(e.style,{overflow:""});break;case"disable":Object.assign(e.style,{overflow:"hidden"})}}}},{key:"addEventListeners",value:function(){this.modal.addEventListener("touchstart",this.onClick),this.modal.addEventListener("click",this.onClick),document.addEventListener("keydown",this.onKeydown)}},{key:"removeEventListeners",value:function(){this.modal.removeEventListener("touchstart",this.onClick),this.modal.removeEventListener("click",this.onClick),document.removeEventListener("keydown",this.onKeydown)}},{key:"onClick",value:function(t){t.target.hasAttribute(this.config.closeTrigger)&&this.closeModal(t)}},{key:"onKeydown",value:function(t){27===t.keyCode&&this.closeModal(t),9===t.keyCode&&this.retainFocus(t)}},{key:"getFocusableNodes",value:function(){var e=this.modal.querySelectorAll(t);return Array.apply(void 0,Ct(e))}},{key:"setFocusToFirstNode",value:function(){var t=this;if(!this.config.disableFocus){var e=this.getFocusableNodes();if(0!==e.length){var n=e.filter((function(e){return!e.hasAttribute(t.config.closeTrigger)}));n.length>0&&n[0].focus(),0===n.length&&e[0].focus()}}}},{key:"retainFocus",value:function(t){var e=this.getFocusableNodes();if(0!==e.length)if(e=e.filter((function(t){return null!==t.offsetParent})),this.modal.contains(document.activeElement)){var n=e.indexOf(document.activeElement);t.shiftKey&&0===n&&(e[e.length-1].focus(),t.preventDefault()),!t.shiftKey&&e.length>0&&n===e.length-1&&(e[0].focus(),t.preventDefault())}else e[0].focus()}}])&&wt(n.prototype,r),i&&wt(n,i),e}(),n=null,r=function(t){if(!document.getElementById(t))return console.warn("MicroModal: ❗Seems like you have missed %c'".concat(t,"'"),"background-color: #f8f9fa;color: #50596c;font-weight: bold;","ID somewhere in your code. Refer example below to resolve it."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<div class="modal" id="'.concat(t,'"></div>')),!1},i=function(t,e){if(function(t){if(t.length<=0)console.warn("MicroModal: ❗Please specify at least one %c'micromodal-trigger'","background-color: #f8f9fa;color: #50596c;font-weight: bold;","data attribute."),console.warn("%cExample:","background-color: #f8f9fa;color: #50596c;font-weight: bold;",'<a href="#" data-micromodal-trigger="my-modal"></a>')}(t),!e)return!0;for(var n in e)r(n);return!0};return{init:function(t){var r=Object.assign({},{openTrigger:"data-micromodal-trigger"},t),s=Ct(document.querySelectorAll("[".concat(r.openTrigger,"]"))),a=function(t,e){var n=[];return t.forEach((function(t){var r=t.attributes[e].value;void 0===n[r]&&(n[r]=[]),n[r].push(t)})),n}(s,r.openTrigger);if(!0!==r.debugMode||!1!==i(s,a))for(var o in a){var l=a[o];r.targetModal=o,r.triggers=Ct(l),n=new e(r)}},show:function(t,i){var s=i||{};s.targetModal=t,!0===s.debugMode&&!1===r(t)||(n&&n.removeEventListeners(),(n=new e(s)).showModal())},close:function(t){t?n.closeModalById(t):n.closeModal()}}}();window.MicroModal=Dt;class Tt{constructor(){this.state=y.getInstance(),this.modalReference=this.state.getElementFromReference(m.modalContainer),this.currentModal=null,Dt.init({})}static getInstance(){return Tt.instance||(Tt.instance=new Tt),Tt.instance}open(t,e={}){return this.state.isModalOpen()&&this.currentModal&&this.close(this.currentModal),this.currentModal=t,this.setBody(t,e),Dt.show("payment-modal",t.getConfig()),t}close(t){if(this.state.isModalOpen())return this.currentModal=null,Dt.close("payment-modal"),t}setBody(t,e={}){for(;this.modalReference.firstChild;)this.modalReference.removeChild(this.modalReference.firstChild);let n=t.render(e),r=new x(n,{modal:t,parameters:e});w.getInstance().dispatch(r,T.onBeforeDisplayModalEvent);let i=(new DOMParser).parseFromString(r.getSubject(),"text/html");this.modalReference.appendChild(i.body.firstChild)}}class Rt extends C{static onModalOpen(t){Tt.getInstance().open(t.subject,t.parameters)}static onModalClose(t){Tt.getInstance().close(t.subject,t.parameters)}}class Pt extends x{}class It extends b{}class At{static handleException(t,e={}){if(!(t instanceof b))throw t;if(t instanceof It)throw t;let n=w.getInstance();n.dispatch(new D(t,e),T.onDebugEvent);let r=new q(t,e);if(n.dispatch(r,T.onExceptionEvent),!r.hasRecovered()){let r=new D(new Error("Was unable to recover from exception "+t.message),e);throw n.dispatch(r,T.onDebugEvent),new It("Unable to recover from exception.")}if(r.getRecoveredObject()instanceof x&&r.recoverEvent()){let t=r.getRecoveredObject(),e=Object.assign({},r.getParameters(),r.getRecoveredParameters());t.setParameters(e),n.dispatch(t,r.recoverEvent)}return r}}class Mt extends x{constructor(t,e={}){super(t,e=Object.assign({},{redirection_enabled:!0,redirection_url:null,redirection_timeout:2500},e))}}class Ot extends Et{render(t={}){return""+this.response.data.body}}class Bt extends k{constructor(t){super(t)}}class Vt extends x{constructor(t,e={}){super(t,e),this.resolvedModal=null,this.resolvedParameters={}}getResolvedModal(){return this.resolvedModal}setResolvedModal(t){this.resolvedModal=t}}class Lt extends C{static onPaymentCompleteEvent(t){let e=new Vt(new Bt({body:"<p>Your payment was successfully received!</p>"}));w.getInstance().dispatch(e,T.onResolveModalEvent);let n=new Pt(e.getResolvedModal(),e.getParameters());return w.getInstance().dispatch(n,T.onModalOpenEvent),Lt.handleRedirection(t,Lt.createReturnUrl(t))}static onPaymentRequiresChallengeEvent(t){let e=new Vt(t.subject);w.getInstance().dispatch(e,T.onResolveModalEvent);let n=new Pt(e.getResolvedModal(),e.getParameters());w.getInstance().dispatch(n,T.onModalOpenEvent)}static onPaymentFailedEvent(t){if("data"in t.subject&&void 0!==t.subject.data&&"sub_type"in t.subject.data){let e=y.getInstance(),n=[],r=[],i=null;switch(t.subject.data.sub_type){case"card_number_invalid":i="Credit card number not valid.",n.push(e.getElementFromReference(m.creditCardNumber));break;case"card_not_accepted":i="Credit card was not accepted.",n.push(e.getElementFromReference(m.creditCardNumber)),n.push(e.getElementFromReference(m.creditCardCvv)),n.push(e.getElementFromReference(m.creditCardExpirationMonth)),n.push(e.getElementFromReference(m.creditCardExpirationYear));break;case"card_cvc_invalid":i="Verification code not valid.",n.push(e.getElementFromReference(m.creditCardCvv));break;case"error_processing":case"error_payment_failed":i="Failed to complete payment, please try again later.",r.push(e.getElementFromReference(m.creditCardNumber)),r.push(e.getElementFromReference(m.creditCardCvv)),r.push(e.getElementFromReference(m.creditCardExpirationMonth)),r.push(e.getElementFromReference(m.creditCardExpirationYear))}n.forEach((function(t){t.setAttribute("data-validation","invalid")})),r.forEach((function(t){t.setAttribute("data-validation","")})),i&&(t.getSubject().data.message=i)}let e=new Vt(t.subject);w.getInstance().dispatch(e,T.onResolveModalEvent);let n=new Pt(e.getResolvedModal(),e.getParameters());w.getInstance().dispatch(new U(t.getSubject(),{state:{loading:!1,formSubmitted:!1}}),T.onStateChangeEvent),w.getInstance().dispatch(n,T.onModalOpenEvent)}static createReturnUrl(t){let e=new URL(t.parameters.paymentCompleteUrl),n=t.getParameter("urlParameters",{});try{Object.entries(n).forEach(([t,n])=>{e.searchParams.set(t,n)})}catch(t){}return e.toString()}static handleRedirection(t,e){if(t.getParameter("redirection_enabled")){let n=e;setTimeout((function(){let e=null!==t.getParameter("redirection_url")?t.getParameter("redirection_url"):n;window.location.replace(e)}),t.getParameter("redirection_timeout"))}}}class Ft extends x{}class kt extends b{}class Nt extends Et{constructor(t){super(t)}render(t={}){return this.threeDSv1(t)}threeDSv1(t={}){return this.response.getChallengePayload()}threeDSv2(t={}){throw new kt}}class jt extends C{static onResolveModal(t){let e=t.subject,n=null;if(e instanceof N&&(n=new Nt(e)),e instanceof j&&(n=new St(e)),e instanceof Bt&&(n=new Ot(e)),!n)throw new Error("Could not resolve modal");t.setResolvedModal(n)}}class _t extends x{}class Ht extends b{}class qt{static onStateChangeEvent(t){if(!(t instanceof U))throw new Ht("PaymentFormListener only supports StateChangeEvent.");let e=y.getInstance();qt.formSubmission(e)}static formSubmission(t){let e=t.getElementFromReference(m.submitButton);e.setAttribute("data-loading-state",t.isLoading()||t.isFormSubmitted()?"1":"0"),t.isFormReadyForSubmission()?e.removeAttribute("disabled"):e.hasAttribute("disabled")||e.setAttribute("disabled","disabled")}}class Ut{static onStateChangeEvent(t){if(!(t instanceof U))throw new Ht("PaymentFormListener only supports StateChangeEvent.");let e=y.getInstance();Ut.formElementsDisable(e)}static formElementsDisable(t){let e=[t.getElementFromReference(m.creditCardHolder),t.getElementFromReference(m.creditCardNumber),t.getElementFromReference(m.creditCardCvv),t.getElementFromReference(m.creditCardExpiration),t.getElementFromReference(m.creditCardExpirationMonth),t.getElementFromReference(m.creditCardExpirationYear)];for(const n in Object.keys(e)){let r=e[n];r&&(t.isFormSubmitted()?(r.hasAttribute("disabled")||r.setAttribute("disabled","disabled"),r.hasAttribute("required")&&r.removeAttribute("required")):(r.hasAttribute("disabled")&&r.removeAttribute("disabled"),r.hasAttribute("required")||r.setAttribute("required","required")))}}}class Kt extends x{}class Yt{constructor(t){void 0!==t.public_keys&&(t.public_keys=I.fromJson(t.public_keys)),this.config=Object.assign({},{debug:!1,refresh_url:"https://rest-api.pay.nl/v2/encryption/publicKeys/json",post_url:null,payment_complete_url:null,form_input_payload_name:"pay_encrypted_data",form_selector:"data-pay-encrypt-form",field_selector:"data-pay-encrypt-field",field_value_reader:"name",public_keys:[],merchant_identifier:null,html5_enhanced_validation:!0,default_cvv_label:"CVC",default_card_number_length:19,bind:{submit:!0},icons:{creditcard:{default:"/img/creditcard/mono/generic.svg",alipay:"/img/creditcard/logo/alipay.svg","american-express":"/img/creditcard/logo/amex.svg","diners-club":"/img/creditcard/logo/diners.svg",discover:"/img/creditcard/logo/discover.svg",elo:"/img/creditcard/logo/elo.svg",hiper:"/img/creditcard/logo/hiper.svg",hipercard:"/img/creditcard/logo/hipercard.svg",jcb:"/img/creditcard/logo/jcb.svg",maestro:"/img/creditcard/logo/maestro.svg",mastercard:"/img/creditcard/logo/mastercard.svg",mir:"/img/creditcard/logo/mir.svg",unionpay:"/img/creditcard/logo/unionpay.svg",visa:"/img/creditcard/logo/visa.svg"},cvc:"/img/creditcard/mono/code.svg"}},t),this.state=y.getInstance(),this.state.setConfig(this.config),this.registerDefaultEventListeners()}getConfig(){return this.config}getEventDispatcher(){return w.getInstance()}init(){let t=this.getElementByReference(m.form);!0===this.config.html5_enhanced_validation&&this.applyAttributesToElementsOfForm(t),this.createPayloadInput(t),this.bindings(),this.triggerEventsWhenFormAlreadyHasInput(),this.registerPaymentCompleteListener(),this.registerErrorListener(),this.debug("Initialization complete.")}bindings(){this.bindCreditCardHolder(),this.bindCreditCardNumberInput(),this.bindCreditCardCvcInput(),this.bindCreditCardExpirationMonth(),this.bindCreditCardExpirationYear(),this.config.bind.submit&&this.bindForm()}handleFormSubmission(t){let e={},n=new L,r=new A(this.config.public_keys,this.config.refresh_url),i=this;const s=this.config.field_selector,a=this.config.field_value_reader,o=this.config.merchant_identifier;i.getEventDispatcher().dispatch(new U(t,{validation:null,state:{loading:!0,formSubmitted:!0}}),T.onStateChangeEvent),r.getUnexpiredPublicKey().then(r=>{t.querySelectorAll("["+s+"]").forEach((function(t){let n=t.getAttribute(a);e[n]=t.value}));let l={identifier:r.identifier,merchant_identifier:o,payment_complete_url:i.config.payment_complete_url,data:n.encrypt(r.getKey(),JSON.stringify(e)).toString()},c=new FormData;c.set("pay_encrypted_data",JSON.stringify(l));let u=this.config.post_url,h=null===u?t.getAttribute("action"):u,d=new Kt(c,{form_action:h});w.getInstance().dispatch(d,T.onSubmitDataEvent),w.getInstance().dispatch(new D("Posting form data.",{url:h,data:d.getSubject()}),T.onDebugEvent),fetch(d.getParameter("form_action"),{method:"POST",cache:"no-cache",redirect:"follow",body:d.getSubject()}).then((t,e)=>{if(t.ok)return w.getInstance().dispatch(new D("Received RAW response.",{response:t}),T.onDebugEvent),t;e(Error("Unexpected response from server."))}).then(t=>(w.getInstance().dispatch(new D("Converting RAW response to JSON.",{response:t}),T.onDebugEvent),t.json().catch(()=>{throw new Error("Invalid JSON returned.")}))).then(t=>{let e=new F(t);w.getInstance().dispatch(e,T.onResponseFactoryEvent);let n=e.hasParameter("response")&&e.getParameter("response")instanceof k?e.getParameter("response"):null;if(!n)throw new Error("Invalid response");return n}).then(t=>{switch(t.getType()){case"error":return void i.getEventDispatcher().dispatch(new Ft(t),T.onPaymentFailedEvent);case"challenge":return void w.getInstance().dispatch(new _t(t),T.onPaymentRequiresChallengeEvent);case"transaction":return void w.getInstance().dispatch(new Mt(t,{encryptedForm:i,paymentCompleteUrl:i.config.payment_complete_url,urlParameters:{orderId:t.data.orderId,entranceCode:t.data.entranceCode}}),T.onPaymentCompleteEvent)}}).catch(e=>{i.getEventDispatcher().dispatch(new U(t,{validation:null,state:{loading:!1,formSubmitted:!1},exception:e}),T.onStateChangeEvent),At.handleException(e)})}).catch(e=>{i.getEventDispatcher().dispatch(new U(t,{validation:null,state:{loading:!1,formSubmitted:!1},exception:e}),T.onStateChangeEvent),At.handleException(e)})}bindForm(){let t=this.getElementByReference(m.form),e=this;t.addEventListener("submit",(function(n){n.preventDefault(),e.handleFormSubmission(t)}))}bindCreditCardHolder(){let t=this;document.addEventListener("input",(function(e){let n=t.getElementByReference(m.creditCardHolder);if(e.target!==n)return;let r=vt.cardholderName(n.value),i=t.getValidationAttributeValue(r);n.setAttribute("data-validation",i),t.getEventDispatcher().dispatch(new U(n,{validation:n.getAttribute("data-validation"),state:{cardHolderInputComplete:"valid"===i}}),T.onStateChangeEvent)}))}bindCreditCardNumberInput(){let t=this,e="default",n=t.getElementByReference(m.creditCardImage);document.addEventListener("input",(function(r){let i=t.getElementByReference(m.creditCardNumber);if(r.target!==i)return;let s=t.getElementByReference(m.creditCardCvv),a=t.getElementByReference(m.creditCardCvvLabel),o=i.value,l=vt.number(o);e=null!==l.card&&null!==l.card.type?l.card.type:"default",t.renderCreditCardImage(n,e in t.config.icons.creditcard?e:"default");let c=null!==l.card?Math.max(...l.card.lengths):t.config.default_card_number_length,u=(o.match(/\s/g)||[]).length,h=null!==l.card?l.card.code.size:"4",d=t.getValidationAttributeValue(l);i.setAttribute("data-validation",d),i.setAttribute("maxlength",(c+u).toString()),i.setAttribute("minlength",c),t.getEventDispatcher().dispatch(new U(i,{validation:i.getAttribute("data-validation"),state:{cardNumberInputComplete:"valid"===i.getAttribute("data-validation")}}),T.onStateChangeEvent),s.setAttribute("minlength",h),s.setAttribute("maxlength",h),t.getEventDispatcher().dispatch(new U(s,{validation:s.getAttribute("data-validation"),state:{cardCvvInputComplete:"valid"===d}}),T.onStateChangeEvent),a.innerHTML=null!==l.card?l.card.code.name:t.config.default_cvv_label})),new g('input[name="cardnumber"]',{creditCard:!0,creditCardStrictMode:!0}),this.renderCreditCardImage(n,e)}bindCreditCardCvcInput(){let t=this;this.getElementByReference(m.creditCardCvvImage).src=this.config.icons.cvc,document.addEventListener("input",(function(e){let n=t.getElementByReference(m.creditCardNumber),r=t.getElementByReference(m.creditCardCvv);if(e.target!==r)return;let i=vt.number(n.value),s=null;s=null!==i.card&&null!==i.card.code?vt.cvv(r.value,i.card.code.size):vt.cvv(r.value);let a=t.getValidationAttributeValue(s);r.setAttribute("data-validation",a),t.getEventDispatcher().dispatch(new U(r,{validation:r.getAttribute("data-validation"),state:{cardCvvInputComplete:"valid"===a}}),T.onStateChangeEvent)}))}bindCreditCardExpirationMonth(){let t=this;document.addEventListener("change",(function(e){let n=t.getElementByReference(m.creditCardExpirationMonth),r=t.getElementByReference(m.creditCardExpirationYear);e.target===n&&(t.validateMonthYearCombination(t.getElementByReference(m.form)),t.getEventDispatcher().dispatch(new U(n,{validation:n.getAttribute("data-validation"),state:{cardExpiryMonthInputComplete:"valid"===n.getAttribute("data-validation"),cardExpiryYearInputComplete:"valid"===r.getAttribute("data-validation")}}),T.onStateChangeEvent))}))}bindCreditCardExpirationYear(t){let e=this;document.addEventListener("change",(function(n){let r=e.getElementByReference(m.creditCardExpirationMonth),i=e.getElementByReference(m.creditCardExpirationYear);n.target===i&&(e.validateMonthYearCombination(t),e.getEventDispatcher().dispatch(new U(i,{validation:i.getAttribute("data-validation"),state:{cardExpiryMonthInputComplete:"valid"===r.getAttribute("data-validation"),cardExpiryYearInputComplete:"valid"===i.getAttribute("data-validation")}}),T.onStateChangeEvent))}))}triggerEventsWhenFormAlreadyHasInput(){[this.getElementByReference(m.creditCardHolder),this.getElementByReference(m.creditCardNumber),this.getElementByReference(m.creditCardCvv),this.getElementByReference(m.creditCardExpirationMonth),this.getElementByReference(m.creditCardExpirationYear)].forEach((function(t){if(t.value){let e=null;switch(t.nodeName.toLowerCase()){case"select":e="change";break;case"input":e="input"}let n=new Event(e,{bubbles:!0});t.dispatchEvent(n)}}))}validateMonthYearCombination(){let t=this.getElementByReference(m.creditCardExpirationMonth),e=this.getElementByReference(m.creditCardExpirationYear),n=vt.expirationDate({month:t.value,year:e.value});return t.setAttribute("data-validation",this.getValidationAttributeValue(n)),e.setAttribute("data-validation",this.getValidationAttributeValue(n)),n}registerPaymentCompleteListener(){let t=this;window.addEventListener("payment-complete",(function(e){let n=new Mt(e,{encryptedForm:this,originalEvent:e,paymentCompleteUrl:t.config.payment_complete_url,urlParameters:e.detail});w.getInstance().dispatch(n,T.onPaymentCompleteEvent)}))}registerErrorListener(){let t=this;window.addEventListener("error",(function(e){let n=new j(e.detail),r=new Ft(n,{encryptedForm:this,originalEvent:e,paymentCompleteUrl:t.config.payment_complete_url,urlParameters:e.detail});w.getInstance().dispatch(r,T.onPaymentFailedEvent)}))}applyAttributesToElementsOfForm(t){let e=this.config.field_selector,n=this.config.field_value_reader;t.querySelectorAll("["+e+"]").forEach((function(t){let e=Yt.getAttributesForField(n,t);Yt.applyAttributesToField(t,e)}))}static applyAttributesToField(t,e){for(let[n,r]of Object.entries(e))"function"==typeof r&&(r=r(t)),null===r||t.hasAttribute(n)||t.setAttribute(n,r)}static getAttributesForField(t,e){let n=e.getAttribute(t),r=Yt.getAttributes();if(void 0===r[n])throw Error("Unknown field: "+e);return Object.assign({},Yt.getDefaultAttributes(),r[n])}getValidationAttributeValue(t){return t.isValid||t.isPotentiallyValid?t.isValid&&t.isPotentiallyValid?"valid":t.isPotentiallyValid?"potentially-valid":null:"invalid"}getElementByReference(t){return this.state.getElementFromReference(t)}static getAttributes(){return{cardholder:{},cardnumber:{type:"text",minlength:function(t){return"number"===t.getAttribute("type")?13:null},maxlength:function(t){return"number"===t.getAttribute("type")?16:null},inputmode:"numeric",autocomplete:"cc-number",autocorrect:"off"},cardcvc:{minlength:function(t){return"number"===t.getAttribute("type")?3:null},maxlength:function(t){return"number"===t.getAttribute("type")?4:null},pattern:function(t){return"text"===t.getAttribute("type")||null===t.getAttribute("type")?"[0-9]{3,4}":null},inputmode:"numeric",autocomplete:"cc-csc",autocorrect:"off"},expiry:{pattern:"(20|21)[0-9]{2}-[0-9]{2}",inputmode:"numeric",autocomplete:"cc-exp",autocorrect:"off"},valid_thru_month:{pattern:"(0[1-9]|1[012])",inputmode:"numeric",autocomplete:"cc-exp-month",autocorrect:"off"},valid_thru_year:{pattern:"(20|21)[0-9]{2}",inputmode:"numeric",autocomplete:"cc-exp-year",autocorrect:"off"}}}static getDefaultAttributes(){return{required:"required"}}createPayloadInput(t){let e=document.createElement("input");return e.setAttribute("type","hidden"),e.setAttribute("name",this.config.form_input_payload_name),t.appendChild(e),t}renderCreditCardImage(t,e){t.src=this.config.icons.creditcard[e]}debug(t,e={}){!1!==this.config.debug&&this.getEventDispatcher().dispatch(new D(t,e),T.onDebugEvent)}registerDefaultEventListeners(){this.config.debug?this.registerDebugListeners():this.getEventDispatcher().addListener(T.onDebugEvent,t=>R.onDebugNull(t),50),this.getEventDispatcher().addListener(T.onPaymentRequiresChallengeEvent,t=>Lt.onPaymentRequiresChallengeEvent(t),50),this.getEventDispatcher().addListener(T.onPaymentCompleteEvent,t=>Lt.onPaymentCompleteEvent(t),50),this.getEventDispatcher().addListener(T.onPaymentCompleteEvent,t=>yt.onPaymentCompleteEvent(t),60),this.getEventDispatcher().addListener(T.onPaymentFailedEvent,t=>yt.onPaymentFailedEvent(t),60),this.getEventDispatcher().addListener(T.onPaymentFailedEvent,t=>Lt.onPaymentFailedEvent(t),50),this.getEventDispatcher().addListener(T.onResponseEvent,t=>Y.onResponseEvent(t),50),this.getEventDispatcher().addListener(T.onResponseFactoryEvent,t=>K.onResponseEvent(t),50),this.getEventDispatcher().addListener(T.onStateChangeEvent,t=>yt.onStateChangeEvent(t),50),this.getEventDispatcher().addListener(T.onStateChangeEvent,t=>qt.onStateChangeEvent(t),50),this.getEventDispatcher().addListener(T.onStateChangeEvent,t=>Ut.onStateChangeEvent(t),50),this.getEventDispatcher().addListener(T.onModalOpenEvent,t=>Rt.onModalOpen(t),50),this.getEventDispatcher().addListener(T.onModalCloseEvent,t=>Rt.onModalClose(t),50),this.getEventDispatcher().addListener(T.onResolveModalEvent,t=>jt.onResolveModal(t),50)}registerDebugListeners(){this.getEventDispatcher().addListener(T.onDebugEvent,t=>R.onDebugEvent(t),50),this.getEventDispatcher().addListener(T.onModalCloseEvent,t=>R.onModalCloseEvent(t),50),this.getEventDispatcher().addListener(T.onModalOpenEvent,t=>R.onModalOpenEvent(t),50),this.getEventDispatcher().addListener(T.onPaymentCompleteEvent,t=>R.onPaymentCompleteEvent(t),50),this.getEventDispatcher().addListener(T.onPaymentFailedEvent,t=>R.onPaymentFailedEvent(t),50),this.getEventDispatcher().addListener(T.onResponseFactoryEvent,t=>R.onResponseFactoryEvent(t),50),this.getEventDispatcher().addListener(T.onRequestEvent,t=>R.onRequestEvent(t),50),this.getEventDispatcher().addListener(T.onResponseEvent,t=>R.onResponseEvent(t),50),this.getEventDispatcher().addListener(T.onStateChangeEvent,t=>R.onStateChangeEvent(t),50)}}t.DebugEvent=D,t.Elements=m,t.EncryptedForm=Yt,t.ErrorModal=St,t.EventDispatcher=w,t.Events=T,t.GenericEvent=x,t.ModalCloseEvent=bt,t.ModalListener=Rt,t.ModalOpenEvent=Pt,t.PaymentCompleteEvent=Mt,t.PaymentCompleteModal=Ot,t.PaymentFailedEvent=Ft,t.PaymentListener=Lt,t.ResponseFactoryEvent=F,t.ResponseFactoryListener=K,t.ResponseToJsonListener=Y,t.StateChangeEvent=U,t.StateChangeListener=yt,Object.defineProperty(t,"__esModule",{value:!0})}));
